<!DOCTYPE html>
<html lang="en-us"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name"> | My New Hugo Site</title>
<meta property="og:title" content=" | My New Hugo Site" />
<meta name="twitter:title" content=" | My New Hugo Site" />
<meta itemprop="name" content=" | My New Hugo Site" />
<meta name="application-name" content=" | My New Hugo Site" />
<meta property="og:site_name" content="" />

<meta name="description" content="">
<meta itemprop="description" content="" />
<meta property="og:description" content="" />
<meta name="twitter:description" content="" />

<meta property="og:locale" content="en-us" />
<meta name="language" content="en-us" />

  <link rel="alternate" hreflang="en" href="http://localhost:1313/linux/rhcsa/18.-the-secure-shell-service/" title="" />






<meta name="generator" content="Hugo 0.134.3">

    
    <meta property="og:url" content="http://localhost:1313/linux/rhcsa/18.-the-secure-shell-service/">
  <meta property="og:site_name" content="My New Hugo Site">
  <meta property="og:title" content="My New Hugo Site">
  <meta property="og:description" content="The OpenSSH Service Secure Shell (SSH)
delivers a secure mechanism for data transmission between source and destination systems over IP networks. designed to replace the old remote login programs that transmitted user passwords in clear text and data unencrypted. employs digital signatures for user authentication with encryption to secure a communication channel. this makes it extremely hard for unauthorized people to gain access to passwords or the data in transit. Monitors the data being transferred throughout a session to ensure integrity. Includes a set of utilities ssh and sftp for remote users to log in, transfer files, and execute commands securely. Common Encryption Techniques Two common techniques: symmetric and asymetric Symmetric Technique">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="linux">


    
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="My New Hugo Site">
  <meta name="twitter:description" content="The OpenSSH Service Secure Shell (SSH)
delivers a secure mechanism for data transmission between source and destination systems over IP networks. designed to replace the old remote login programs that transmitted user passwords in clear text and data unencrypted. employs digital signatures for user authentication with encryption to secure a communication channel. this makes it extremely hard for unauthorized people to gain access to passwords or the data in transit. Monitors the data being transferred throughout a session to ensure integrity. Includes a set of utilities ssh and sftp for remote users to log in, transfer files, and execute commands securely. Common Encryption Techniques Two common techniques: symmetric and asymetric Symmetric Technique">


    

    <link rel="canonical" href="http://localhost:1313/linux/rhcsa/18.-the-secure-shell-service/">
    <link href="/style.min.e390ba7da26222f4dc42a349955d76dbbe44e5ce2535a43de5a70633a0a9ec3c.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="http://localhost:1313/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    </head>
<body data-theme = "" class="notransition">

<script src="/js/theme.js"></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="http://localhost:1313/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title></title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
                
                
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title"></h1>
                
            </header>
            
            <div class="page-content">
                <h1 id="the-openssh-service">The OpenSSH Service</h1>
<p><strong>Secure Shell (SSH)</strong></p>
<ul>
<li>delivers a secure mechanism for data transmission between source and destination systems over IP networks.</li>
<li>designed to replace the old remote login programs that transmitted user passwords in clear text and data unencrypted.</li>
<li>employs digital signatures for user authentication with encryption to secure a communication channel.
<ul>
<li>this makes it extremely hard for unauthorized people to gain access to passwords or the data in transit.</li>
</ul>
</li>
<li>Monitors the data being transferred throughout a session to ensure integrity.</li>
<li>Includes a set of utilities <code>ssh</code> and <code>sftp</code> for remote users to log in, transfer files, and execute commands securely.</li>
</ul>
<h3 id="common-encryption-techniques">Common Encryption Techniques</h3>
<ul>
<li>Two common techniques: symmetric and asymetric</li>
</ul>
<p><strong>Symmetric Technique</strong></p>
<ul>
<li>Secret key encryption</li>
<li>Uses a single key called a secret key that is generated as a result of a negotiation process between two entities at the time of their initial contact.</li>
<li>Both sides use the same secret key during subsequent communication for data encryption and decryption.</li>
</ul>
<p><strong>Asymmetric Technique</strong></p>
<ul>
<li>Public key encryption</li>
<li>Combination of private and public keys
<ul>
<li>Randomly generated and mathematically related strings of alphanumeric characters</li>
<li>attached to messages being exchanged.</li>
</ul>
</li>
<li>The client transmutes the information with a public key and the server decrypts it with the paired private key.</li>
<li>Private key must be kept secure since it is private to a single sender</li>
<li>the public key is disseminated to clients.</li>
<li>used for channel encryption and user authentication.</li>
</ul>
<h3 id="authentication-methods">Authentication Methods</h3>
<ul>
<li>Encrypted channel is established between the client and server</li>
<li>Then additional negotiations take place between the two to authenticate the user trying to access the server.</li>
<li>Methods listed in the order in which they are attempted during the authentication process:</li>
</ul>
<ol>
<li>GSSAPI-based ( Generic Security Service Application Program Interface) authentication</li>
<li>Host-based authentication</li>
<li>Public key-based authentication</li>
<li>Challenge-response authentication</li>
<li>Password-based authentication</li>
</ol>
<p><strong>GSSAPI-Based Authentication</strong></p>
<ul>
<li>Provides a standard interface that allows security mechanisms, such as Kerberos, to be plugged in.</li>
<li>OpenSSH uses this interface and the underlying Kerberos for authentication.</li>
<li>Exchange of tokens takes place between the client and server to validate user identity.</li>
</ul>
<p><strong>Host-Based Authentication</strong></p>
<ul>
<li>Allows a single user, a group of users, or all users on the client to be authenticated on the server.</li>
<li>A user may be configured to log in with a matching username on the server or as a different user that already exists there.</li>
<li>For each user that requires an automatic entry on the server, a ~/.shosts file is set up containing the client name or IP address, and, optionally, a different username.</li>
<li>The same rule applies to a group of users or all users on the client that require access to the server.
<ul>
<li>In that case, the setup is done in the /etc/ssh/shosts.equiv file on the server.</li>
</ul>
</li>
</ul>
<p><strong>Private/Public Key-Based Authentication</strong></p>
<ul>
<li>Uses a private/public key combination for user authentication.</li>
<li>User on the client has a private key and the server stores the corresponding public key.</li>
<li>At the login attempt, the server prompts the user to enter the passphrase associated with the key and logs the user in if the passphrase and key are validated.</li>
</ul>
<p><strong>Challenge-Response Authentication</strong></p>
<ul>
<li>Based on the response(s) to one or more arbitrary challenge questions that the user has to answer correctly in order to be allowed to log in to the server.</li>
</ul>
<p><strong>Password-Based Authentication</strong></p>
<ul>
<li>Last fall back option.</li>
<li>Server prompts the user to enter their password.</li>
<li>Checks the password against the stored entry in the shadow file and allows the user in if the password is confirmed.</li>
</ul>
<h3 id="openssh-protocol-version-and-algorithms">OpenSSH Protocol Version and Algorithms</h3>
<ul>
<li>V2</li>
<li>Supports various algorithms for data encryption and user authentication (digital signatures) such as:</li>
</ul>
<p><strong>RSA</strong> (Rivest-Shamir-Adleman)</p>
<ul>
<li>More prevalent than the rest</li>
<li>Supports both encryption and authentication. In contrast,</li>
</ul>
<p><strong>DSA and ECDSA</strong> (Digital Signature Algorithm and Elliptic Curve Digital Signature Algorithm)</p>
<ul>
<li>Authentication only.</li>
<li>Used to generate public and private key pairs for the asymmetric technique.</li>
</ul>
<h3 id="openssh-packages">OpenSSH Packages</h3>
<ul>
<li>Installed during OS installation</li>
</ul>
<p><strong>openssh</strong></p>
<ul>
<li>provides the ssh-keygen command and some library routines</li>
</ul>
<p><strong>openssh-clients</strong></p>
<ul>
<li>includes commands, such as <code>sftp</code>, <code>ssh</code>, and <code>ssh-copy-id</code>, and a client configuration file <em>/etc/ssh/ssh_config</em></li>
</ul>
<p><strong>openssh-server</strong></p>
<ul>
<li>contains the sshd service daemon, server configuration file <em>/etc/ssh/sshd_config</em>, and library routines.</li>
</ul>
<h3 id="openssh-server-daemon-and-client-commands">OpenSSH Server Daemon and Client Commands</h3>
<ul>
<li>OpenSSH server program is sshd</li>
</ul>
<p><strong>sshd</strong></p>
<ul>
<li>
<p>Preconfigured and operational on new RHEL installations</p>
</li>
<li>
<p>Allows remote users to log in to the system using an ssh client program such as PuTTY or the ssh command.</p>
</li>
<li>
<p>Daemon listens on TCP port 22</p>
<ul>
<li>Documented in the /etc/ssh/sshd_config file with the Port directive.</li>
</ul>
</li>
<li>
<p>Use sftp instead of scp do to scp security flaws.</p>
</li>
</ul>
<p><code>sftp</code></p>
<ul>
<li>Secure remote file transfer program</li>
</ul>
<p><code>ssh</code></p>
<ul>
<li>Secure remote login command</li>
</ul>
<p><code>ssh-copy-id</code></p>
<ul>
<li>Copies public key to remote systems</li>
</ul>
<p><code>ssh-keygen</code></p>
<ul>
<li>Generates and manages private and public key pairs</li>
</ul>
<h3 id="server-configuration-file">Server Configuration File</h3>
<p><strong>/etc/ssh/sshd_config</strong></p>
<p><strong>/var/log/secure</strong></p>
<ul>
<li>log file is used to capture authentication messages.</li>
</ul>
<p>View directives listed in <em>/etc/ssh/sshd_config</em>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@server30 tmp<span style="color:#f92672">]</span><span style="color:#75715e"># cat /etc/ssh/sshd_config</span>
</span></span></code></pre></div><p><strong>Port</strong></p>
<ul>
<li>Port number to listen on. Default is 22.</li>
</ul>
<p><strong>Protocol</strong></p>
<ul>
<li>Default protocol version to use.</li>
</ul>
<p><strong>ListenAddress</strong></p>
<ul>
<li>Sets the local addresses the sshd service should listen on.</li>
<li>Default is to listen on all local addresses.</li>
</ul>
<p><strong>SyslogFacility</strong></p>
<ul>
<li>Defines the facility code to be used when logging messages to the /var/log/secure file. This is based on the configuration in the /etc/rsyslog.conf file. Default is <strong>AUTHPRIV.</strong></li>
</ul>
<p><strong>LogLevel</strong>                         <br>
Identifies the level of criticality for the messages to be logged. Default is <strong>INFO</strong>.</p>
<p><strong>PermitRootLogin</strong>                  <br>
Allows or disallows the root user to log in directly to the system. Default is yes.</p>
<p><strong>PubKeyAuthentication</strong>             <br>
Enables or disables public key-based authentication. Default is yes.</p>
<p><strong>AuthorizedKeysFile</strong>               <br>
Sets the name and location of the file containing a user&rsquo;s authorized keys. Default is ~/.ssh/authorized_keys.</p>
<p><strong>PasswordAuthentication</strong>           <br>
Enables or disables local password authentication. Default is yes.</p>
<p><strong>PermitEmptyPasswords</strong>             <br>
Allows or disallows the use of null passwords. Default is no.</p>
<p><strong>ChallengeResponseAuthentication</strong>  <br>
Enables or disables challenge-response authentication mechanism. Default is yes.</p>
<p><strong>UsePAM</strong>                           <br>
Enables or disables user authentication via PAM. If enabled, only root will be able to run the sshd daemon. Default is yes.</p>
<p><strong>X11Forwarding</strong>                    <br>
Allows or disallows remote access to graphical applications. Default is yes.</p>
<h3 id="client-configuration-file">Client Configuration File</h3>
<p><strong>/etc/ssh/ssh_config</strong></p>
<ul>
<li>Local configuration file that directs how the client should behave. This file, , is located in the /etc/ssh directory.</li>
<li>Directives preset in this file that affect all outbound ssh communication.</li>
</ul>
<p>View the default directive settings:
<code>[root@server30 tmp]# cat /etc/ssh/sshd_config</code></p>
<p><strong>Host</strong></p>
<ul>
<li>Container that declares directives applicable to one host, a group of hosts, or all hosts.</li>
<li>Ends when another occurrence of Host or Match is encountered. Default is *,  (all hosts)</li>
</ul>
<p><strong>ForwardX11</strong></p>
<ul>
<li>Enables or disables automatic redirection of X11 traffic over SSH connections.</li>
<li>Default is no.</li>
</ul>
<p><strong>PasswordAuthentication</strong></p>
<ul>
<li>Allows or disallows password authentication.</li>
<li>Default is yes.</li>
</ul>
<p><strong>StrictHostKeyChecking</strong></p>
<ul>
<li>
<p>Whether to add host keys (host fingerprints) to  ~/.ssh/known_hosts when accessing a host for the first time</p>
</li>
<li>
<p>What to do when the keys of a previously accessed host mismatch with what is stored in ~/.ssh/known_hosts.</p>
</li>
<li>
<p>no:</p>
<ul>
<li>Adds new host keys and ignores changes to existing keys.</li>
</ul>
</li>
<li>
<p>yes:</p>
<ul>
<li>Adds new host keys and disallows connections to hosts with non-matching keys.</li>
</ul>
</li>
<li>
<p>accept-new:</p>
<ul>
<li>Adds new host keys and disallows connections to hosts with non-matching keys.</li>
</ul>
</li>
<li>
<p>ask (default):</p>
<ul>
<li>Prompts whether to add new host keys and disallows connections to hosts with non-matching keys.</li>
</ul>
</li>
</ul>
<p><strong>IdentityFile</strong></p>
<ul>
<li>Defines the name and location of a file that stores a user&rsquo;s private key for their identity validation.</li>
<li>Defaults are:
<ul>
<li>id_rsa, id_dsa, and  id_ecdsa based on the type of algorithm used.</li>
<li>Corresponding public key files with .pub extension are also stored at the same directory location.</li>
</ul>
</li>
</ul>
<p><strong>Port</strong>                             <br>
Sets the port number to listen on. Default is 22.</p>
<p><strong>Protocol</strong>                         <br>
Specifies the default protocol version to use</p>
<p>~/.ssh/</p>
<ul>
<li>does not exist by default</li>
<li>created when:
<ul>
<li>a user executes the <code>ssh-keygen</code> command for the first time to generate a key pair</li>
<li>A user connects to a remote ssh server and accepts its host key for the first time.
<ul>
<li>The client stores the server&rsquo;s host key locally in a file called known_hosts along with its hostname or IP address.</li>
<li>On subsequent access attempts, the client will use this information to verify the server&rsquo;s authenticity.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="system-access-and-file-transfer">System Access and File Transfer</h2>
<h3 id="lab-access-rhel-system-from-another-rhel-system">Lab: Access RHEL System from Another RHEL System</h3>
<ul>
<li>issue the ssh command as user1 on server10 to log in to server20.</li>
<li>Run appropriate commands on server20 for validation.</li>
<li>Log off and return to the originating system.</li>
</ul>
<p>1. Issue the ssh command as user1 on server10:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>user1@server30 tmp<span style="color:#f92672">]</span>$ ssh server20
</span></span></code></pre></div><p>2. Issue the basic Linux commands whoami, hostname, and pwd to confirm
that you are logged in as user1 on server20 and placed in the correct
home directory:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>user1@server40 ~<span style="color:#f92672">]</span>$ whoami
</span></span><span style="display:flex;"><span>user1
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>user1@server40 ~<span style="color:#f92672">]</span>$ hostname
</span></span><span style="display:flex;"><span>server40
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>user1@server40 ~<span style="color:#f92672">]</span>$ pwd
</span></span><span style="display:flex;"><span>/home/user1
</span></span></code></pre></div><p>3. Run the logout or the exit command or simply press the key combination Ctrl+d to log off server20 and return to server10:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>user1@server40 ~<span style="color:#f92672">]</span>$ exit
</span></span><span style="display:flex;"><span>logout
</span></span><span style="display:flex;"><span>Connection to server40 closed.
</span></span></code></pre></div><p>If you wish to log on as a different user such as user2 (assuming user2
exists on the target server server20), you may run the ssh command in
either of the following ways:</p>
<p><code>[user1@server30 tmp]$ ssh -l user2 server40</code></p>
<p><code>[user1@server30 tmp]$ ssh user2@server40</code></p>
<h3 id="lab-generate-distribute-and-use-ssh-keys">Lab: Generate, Distribute, and Use SSH Keys</h3>
<ul>
<li>Generate a passwordless ssh key pair using RSA algorithm for user1 on server10.</li>
<li>display the private and public file contents.</li>
<li>Distribute the public key to server20 and attempt to log on to server20 from server10.</li>
<li>Show the log file message for the login attempt.</li>
</ul>
<p>1. Log on to server10 as user1.</p>
<p>2. Generate RSA keys without a password (-N) and without detailed
output (-q). Press Enter when prompted to provide the filename to store
the private key.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>user1@server30 tmp<span style="color:#f92672">]</span>$ ssh-keygen -N <span style="color:#e6db74">&#34;&#34;</span> -q
</span></span><span style="display:flex;"><span>Enter file in which to save the key <span style="color:#f92672">(</span>/home/user1/.ssh/id_rsa<span style="color:#f92672">)</span>: 
</span></span></code></pre></div><p>View the private key:
<code>[user1@server30 tmp]$ cat ~/.ssh/id_rsa</code></p>
<p>View the public key:
<code>[user1@server30 tmp]$ cat ~/.ssh/id_rsa.pub</code></p>
<p>3. Copy the public key file to server20 under /home/user1/.ssh
directory.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>user1@server30 tmp<span style="color:#f92672">]</span>$ ssh-copy-id server40
</span></span><span style="display:flex;"><span>/usr/bin/ssh-copy-id: INFO: Source of key<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span> to be installed: <span style="color:#e6db74">&#34;/home/user1/.ssh/id_rsa.pub&#34;</span>
</span></span><span style="display:flex;"><span>/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span>, to filter out any that are already installed
</span></span><span style="display:flex;"><span>/usr/bin/ssh-copy-id: INFO: <span style="color:#ae81ff">1</span> key<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span> remain to be installed -- <span style="color:#66d9ef">if</span> you are prompted now it is to install the new keys
</span></span><span style="display:flex;"><span>user1@server40<span style="color:#e6db74">&#39;s password: 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Number of key(s) added: 1
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Now try logging into the machine, with:   &#34;ssh &#39;</span>server40<span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">and check to make sure that only the key(s) you wanted were added.
</span></span></span></code></pre></div><ul>
<li>This command also creates or updates the known_hosts
file on server10 and stores the fingerprints for server20 in it.</li>
</ul>
<p><code>[user1@server30 tmp]$ cat ~/.ssh/known_hosts</code></p>
<p>4. On server10, run the ssh command as user1 to connect to server20.
You will not be prompted for a password because there was none assigned
to the ssh keys.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>user1@server30 tmp<span style="color:#f92672">]</span>$ ssh server40
</span></span><span style="display:flex;"><span>Register this system with Red Hat Insights: insights-client --register
</span></span><span style="display:flex;"><span>Create an account or view all your systems at https://red.ht/insights-dashboard
</span></span><span style="display:flex;"><span>Last login: Sun Jul <span style="color:#ae81ff">21</span> 01:20:17 <span style="color:#ae81ff">2024</span> from 192.168.0.30
</span></span></code></pre></div><p>View this login attempt in the /var/log/secure file on server20:
<code>[user1@server40 ~]$ sudo tail /var/log/secure</code></p>
<h3 id="executing-commands-remotely-using-ssh">Executing Commands Remotely Using ssh</h3>
<ul>
<li>Can use <code>ssh</code> command to run programs without remoting in:</li>
</ul>
<p>Execute the hostname command on server20:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>user1@server30 tmp<span style="color:#f92672">]</span>$ ssh server40 hostname
</span></span><span style="display:flex;"><span>server40
</span></span></code></pre></div><p>Run the <code>nmcli</code> command on server20 to show (s) active network connections(c):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>user1@server30 tmp<span style="color:#f92672">]</span>$ ssh server40 nmcli c s
</span></span><span style="display:flex;"><span>NAME    UUID                                  TYPE      DEVICE 
</span></span><span style="display:flex;"><span>enp0s3  1c391bb6-20a3-4eb4-b717-1e458877dbe4  ethernet  enp0s3 
</span></span><span style="display:flex;"><span>lo      175f8a4c-1907-4006-b838-eb43438d847b  loopback  lo 
</span></span></code></pre></div><h3 id="sftp-command">sftp` command</h3>
<ul>
<li>Interactive file transfer tool.</li>
</ul>
<p>On server10, to connect to server20:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>user1@server30 tmp<span style="color:#f92672">]</span>$ sftp server40
</span></span><span style="display:flex;"><span>Connected to server40.
</span></span><span style="display:flex;"><span>sftp&gt; 
</span></span></code></pre></div><p>Type ? at the prompt to list available commands along with a short description:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>user1@server30 tmp<span style="color:#f92672">]</span>$ sftp server40
</span></span><span style="display:flex;"><span>Connected to server40.
</span></span><span style="display:flex;"><span>sftp&gt; ?
</span></span><span style="display:flex;"><span>Available commands:
</span></span><span style="display:flex;"><span>bye                                Quit sftp
</span></span><span style="display:flex;"><span>cd path                            Change remote directory to <span style="color:#e6db74">&#39;path&#39;</span>
</span></span><span style="display:flex;"><span>chgrp <span style="color:#f92672">[</span>-h<span style="color:#f92672">]</span> grp path                Change group of file <span style="color:#e6db74">&#39;path&#39;</span> to <span style="color:#e6db74">&#39;grp&#39;</span>
</span></span><span style="display:flex;"><span>chmod <span style="color:#f92672">[</span>-h<span style="color:#f92672">]</span> mode path               Change permissions of file <span style="color:#e6db74">&#39;path&#39;</span> to <span style="color:#e6db74">&#39;mode&#39;</span>
</span></span><span style="display:flex;"><span>chown <span style="color:#f92672">[</span>-h<span style="color:#f92672">]</span> own path                Change owner of file <span style="color:#e6db74">&#39;path&#39;</span> to <span style="color:#e6db74">&#39;own&#39;</span>
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">[</span>-hi<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>path<span style="color:#f92672">]</span>                    Display statistics <span style="color:#66d9ef">for</span> current directory or
</span></span><span style="display:flex;"><span>                                   filesystem containing <span style="color:#e6db74">&#39;path&#39;</span>
</span></span><span style="display:flex;"><span>exit                               Quit sftp
</span></span><span style="display:flex;"><span>get <span style="color:#f92672">[</span>-afpR<span style="color:#f92672">]</span> remote <span style="color:#f92672">[</span>local<span style="color:#f92672">]</span>         Download file
</span></span><span style="display:flex;"><span>help                               Display this help text
</span></span><span style="display:flex;"><span>lcd path                           Change local directory to <span style="color:#e6db74">&#39;path&#39;</span>
</span></span><span style="display:flex;"><span>lls <span style="color:#f92672">[</span>ls-options <span style="color:#f92672">[</span>path<span style="color:#f92672">]]</span>            Display local directory listing
</span></span><span style="display:flex;"><span>lmkdir path                        Create local directory
</span></span><span style="display:flex;"><span>ln <span style="color:#f92672">[</span>-s<span style="color:#f92672">]</span> oldpath newpath            Link remote file <span style="color:#f92672">(</span>-s <span style="color:#66d9ef">for</span> symlink<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>lpwd                               Print local working directory
</span></span><span style="display:flex;"><span>ls <span style="color:#f92672">[</span>-1afhlnrSt<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>path<span style="color:#f92672">]</span>             Display remote directory listing
</span></span><span style="display:flex;"><span>lumask umask                       Set local umask to <span style="color:#e6db74">&#39;umask&#39;</span>
</span></span><span style="display:flex;"><span>mkdir path                         Create remote directory
</span></span><span style="display:flex;"><span>progress                           Toggle display of progress meter
</span></span><span style="display:flex;"><span>put <span style="color:#f92672">[</span>-afpR<span style="color:#f92672">]</span> local <span style="color:#f92672">[</span>remote<span style="color:#f92672">]</span>         Upload file
</span></span><span style="display:flex;"><span>pwd                                Display remote working directory
</span></span><span style="display:flex;"><span>quit                               Quit sftp
</span></span><span style="display:flex;"><span>reget <span style="color:#f92672">[</span>-fpR<span style="color:#f92672">]</span> remote <span style="color:#f92672">[</span>local<span style="color:#f92672">]</span>        Resume download file
</span></span><span style="display:flex;"><span>rename oldpath newpath             Rename remote file
</span></span><span style="display:flex;"><span>reput <span style="color:#f92672">[</span>-fpR<span style="color:#f92672">]</span> local <span style="color:#f92672">[</span>remote<span style="color:#f92672">]</span>        Resume upload file
</span></span><span style="display:flex;"><span>rm path                            Delete remote file
</span></span><span style="display:flex;"><span>rmdir path                         Remove remote directory
</span></span><span style="display:flex;"><span>symlink oldpath newpath            Symlink remote file
</span></span><span style="display:flex;"><span>version                            Show SFTP version
</span></span><span style="display:flex;"><span>!command                           Execute <span style="color:#e6db74">&#39;command&#39;</span> in local shell
</span></span><span style="display:flex;"><span>!                                  Escape to local shell
</span></span><span style="display:flex;"><span>?                                  Synonym <span style="color:#66d9ef">for</span> help
</span></span></code></pre></div><p>Example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sftp&gt; ls
</span></span><span style="display:flex;"><span>sftp&gt; mkdir /tmp/dir10-20
</span></span><span style="display:flex;"><span>sftp&gt; cd /tmp/dir10-20
</span></span><span style="display:flex;"><span>sftp&gt; pwd
</span></span><span style="display:flex;"><span>Remote working directory: /tmp/dir10-20
</span></span><span style="display:flex;"><span>sftp&gt; put /etc/group
</span></span><span style="display:flex;"><span>Uploading /etc/group to /tmp/dir10-20/group
</span></span><span style="display:flex;"><span>group                                       100% <span style="color:#ae81ff">1118</span>     1.0MB/s   00:00    
</span></span><span style="display:flex;"><span>sftp&gt; ls -l
</span></span><span style="display:flex;"><span>-rw-r--r--    <span style="color:#ae81ff">1</span> user1    user1        <span style="color:#ae81ff">1118</span> Jul <span style="color:#ae81ff">21</span> 01:41 group
</span></span><span style="display:flex;"><span>sftp&gt; cd ..
</span></span><span style="display:flex;"><span>sftp&gt; pwd
</span></span><span style="display:flex;"><span>Remote working directory: /tmp
</span></span><span style="display:flex;"><span>sftp&gt; cd /home/user1
</span></span><span style="display:flex;"><span>sftp&gt; get /usr/bin/gzip
</span></span><span style="display:flex;"><span>Fetching /usr/bin/gzip to gzip
</span></span><span style="display:flex;"><span>gzip                                        100%   90KB  23.0MB/s   00:00    
</span></span><span style="display:flex;"><span>sftp&gt; 
</span></span></code></pre></div><ul>
<li><code>lcd</code>, <code>lls</code>, <code>lpwd</code>, and <code>lmkdir</code> are run on the source server.</li>
<li>Other commands are also available. (See man pages)</li>
</ul>
<p>Type quit at the sftp&gt; prompt to exit the program when you&rsquo;re done:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sftp&gt; quit
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>user1@server30 tmp<span style="color:#f92672">]</span>$ 
</span></span></code></pre></div><h2 id="secure-shell-service-review-questions">Secure Shell Service Review Questions</h2>
<p>Q. Name the SSH client-side configuration file.
A. /etc/ssh/ssh_config</p>
<hr>
<p>Q. What would the command <code>ssh server10 ls</code> do?
A. The command provided will run the ls command on the specified remote ssh server without the need for the user to log in.</p>
<hr>
<p>Q. What would the command <code>ssh-keygen -N &quot;&quot;</code> do?
A. The command provided will generate a passwordless ssh key pair using the default RSA algorithm.</p>
<hr>
<p>Q. What is the default location to store user SSH keys?
A. Under the ~/.ssh directory.</p>
<hr>
<p>Q. What would the command <code>ssh-copy-id</code> do?
A. Distribute the public key to remote systems.</p>
<hr>
<p>Q. Which two of the five authentication methods mentioned in this chapter are more prevalent?
A. The public key-based and password-based authentication methods are more prevalent.</p>
<hr>
<p>Q. What is the use of the <code>ssh-keygen</code> command?
A. Generate public/private key combination for use with ssh.</p>
<hr>
<p>Q. Name the default algorithm used with SSH.
A. The default algorithm used with ssh is RSA.</p>
<hr>
<p>Q. The primary secure shell server configuration file is ssh_config. True or False?
A. False. The primary secure shell configuration file is sshd_config.</p>
<hr>
<p>Q. Which three common algorithms are used with SSH version 2 for encryption and/or authentication?
A. The SSH version 2 uses RSA, DSA, and ECDSA algorithms.</p>
<hr>
<p>Q. What kind of information does the ~/.ssh/known_hosts file store?
A. The ~/.ssh/known_hosts file stores fingerprints of remote servers.</p>
<hr>
<p>Q. List the two encryption techniques described in this chapter.
A. The two encryption techniques are symmetric (secret key) and asymmetric (public key).</p>
<hr>
<p>Q. What is the default port used by the secure shell service?
A. The default port used by the secure shell service is 22.</p>
<hr>
<p>Q. Which log file stores authentication messages?
A. The /var/log/secure file stores authentication messages.</p>
<hr>
<p>Q. The ssh tool provides a non-secure tunnel over a network for accessing a RHEL system. True or False?
A. False. The ssh command provides a secure tunnel over a network.</p>
<h1 id="secure-shell-service-diy-labs">Secure Shell Service DIY Labs</h1>
<h3 id="lab-establish-key-based-authentication">Lab: Establish Key-Based Authentication</h3>
<ul>
<li>Create user account user20 on both systems and assign a password.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@server40 ~<span style="color:#f92672">]</span><span style="color:#75715e"># adduser user20</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@server40 ~<span style="color:#f92672">]</span><span style="color:#75715e"># passwd user20</span>
</span></span><span style="display:flex;"><span>Changing password <span style="color:#66d9ef">for</span> user user20.
</span></span><span style="display:flex;"><span>New password: 
</span></span><span style="display:flex;"><span>BAD PASSWORD: The password is shorter than <span style="color:#ae81ff">8</span> characters
</span></span><span style="display:flex;"><span>Retype new password: 
</span></span><span style="display:flex;"><span>passwd: all authentication tokens updated successfully.
</span></span></code></pre></div><ul>
<li>As user20 on server40, generate a private/public key pair without a passphrase using the ssh-keygen command.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>user20@server40 ~<span style="color:#f92672">]</span><span style="color:#75715e"># ssh-keygen -N &#34;&#34; -q</span>
</span></span><span style="display:flex;"><span>Enter file in which to save the key <span style="color:#f92672">(</span>/root/.ssh/id_rsa<span style="color:#f92672">)</span>: 
</span></span></code></pre></div><ul>
<li>Distribute the public key to server30 with the ssh-copy-id command.
<code>[user20@server40 ~]# ssh-copy-id server30</code></li>
<li>Log on to server30 as user20 and accept the fingerprints for the server if presented.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>user20@server40 ~<span style="color:#f92672">]</span><span style="color:#75715e"># ssh server30</span>
</span></span><span style="display:flex;"><span>Activate the web console with: systemctl enable --now cockpit.socket
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Register this system with Red Hat Insights: insights-client --register
</span></span><span style="display:flex;"><span>Create an account or view all your systems at https://red.ht/insights-dashboard
</span></span><span style="display:flex;"><span>Last login: Fri Jul <span style="color:#ae81ff">19</span> 14:09:22 <span style="color:#ae81ff">2024</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>user20@server30 ~<span style="color:#f92672">]</span><span style="color:#75715e"># </span>
</span></span></code></pre></div><ul>
<li>On subsequent log in attempts from server40 to server30, user20 should not be prompted for their password.</li>
</ul>
<h3 id="lab-test-the-effect-of-permitrootlogin-directive">Lab: Test the Effect of PermitRootLogin Directive</h3>
<ul>
<li>
<p>As user1 with sudo on server30, edit the /etc/ssh/sshd_config file and change the value of the directive PermitRootLogin to &ldquo;no&rdquo;.
<code>[user1@server30 ~]$ sudo vim /etc/ssh/sshd_config</code></p>
</li>
<li>
<p>Use the systemctl command to activate the change.</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>user1@server30 ~<span style="color:#f92672">]</span>$ systemctl restart sshd
</span></span><span style="display:flex;"><span><span style="color:#f92672">====</span> AUTHENTICATING FOR org.freedesktop.systemd1.manage-units <span style="color:#f92672">====</span>
</span></span><span style="display:flex;"><span>Authentication is required to restart <span style="color:#e6db74">&#39;sshd.service&#39;</span>.
</span></span><span style="display:flex;"><span>Authenticating as: root
</span></span><span style="display:flex;"><span>Password: 
</span></span><span style="display:flex;"><span><span style="color:#f92672">====</span> AUTHENTICATION COMPLETE <span style="color:#f92672">====</span>
</span></span></code></pre></div><ul>
<li>As root on server40, run ssh server40 (or use its IP). You&rsquo;ll get permission denied message.</li>
</ul>
<p>(this didn&rsquo;t work, I think it&rsquo;s because I configured passwordless authentication on here)</p>
<ul>
<li>Reverse the change on server40 and retry ssh server40. You should be able to log in.</li>
</ul>

            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
</div>
    <small class="footer_copyright">
        © 2024 .
        
    </small>
</footer>







    
    <script async src="http://localhost:1313/js/main.js" ></script>

    

</body>
</html>
