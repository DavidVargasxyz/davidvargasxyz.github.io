<!DOCTYPE html>
<html lang="en-us"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name"> | David Vargas</title>
<meta property="og:title" content=" | David Vargas" />
<meta name="twitter:title" content=" | David Vargas" />
<meta itemprop="name" content=" | David Vargas" />
<meta name="application-name" content=" | David Vargas" />
<meta property="og:site_name" content="davidvargas.xyz" />

<meta name="description" content="David Vargas&#39;s blog">
<meta itemprop="description" content="David Vargas&#39;s blog" />
<meta property="og:description" content="David Vargas&#39;s blog" />
<meta name="twitter:description" content="David Vargas&#39;s blog" />

<meta property="og:locale" content="en-us" />
<meta name="language" content="en-us" />

  <link rel="alternate" hreflang="en-gb" href="http://localhost:1313/linux/rhcsa/20.-security-enhanced-linux/" title="" />






<meta name="generator" content="Hugo 0.134.3">

    
    <meta property="og:url" content="http://localhost:1313/linux/rhcsa/20.-security-enhanced-linux/">
  <meta property="og:site_name" content="David Vargas">
  <meta property="og:title" content="David Vargas">
  <meta property="og:description" content="SELinux Terminology Implementation of the Mandatory Access Control (MAC) architecture
developed by the U.S. National Security Agency (NSA) flexible, enriched, and granular security controls in Linux. integrated into the Linux kernel as a set of patches using the Linux Security Modules (LSM) framework that allows the kernel to support various security implementations provides an added layer of protection above and beyond the standard Linux Discretionary Access Control (DAC) security architecture. DAC includes: traditional file and directory permissions extended attribute settings setuid/setgid bits su/sudo privileges etc. Limits the ability of a subject (Linux user or process) to access an object (file, directory, file system, device, network interface/connection, port, pipe, socket, etc.) To reduce or eliminate the potential damage the subject may be able to inflict on the system if compromised. MAC controls">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="linux">


    
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="David Vargas">
  <meta name="twitter:description" content="SELinux Terminology Implementation of the Mandatory Access Control (MAC) architecture
developed by the U.S. National Security Agency (NSA) flexible, enriched, and granular security controls in Linux. integrated into the Linux kernel as a set of patches using the Linux Security Modules (LSM) framework that allows the kernel to support various security implementations provides an added layer of protection above and beyond the standard Linux Discretionary Access Control (DAC) security architecture. DAC includes: traditional file and directory permissions extended attribute settings setuid/setgid bits su/sudo privileges etc. Limits the ability of a subject (Linux user or process) to access an object (file, directory, file system, device, network interface/connection, port, pipe, socket, etc.) To reduce or eliminate the potential damage the subject may be able to inflict on the system if compromised. MAC controls">


    

    <link rel="canonical" href="http://localhost:1313/linux/rhcsa/20.-security-enhanced-linux/">
    <link href="/style.min.1915b95fdbf4046da0032dde0fb966271ed904fa9c019f9a326d7ce001902895.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="http://localhost:1313/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    </head>
<body data-theme = "dark" class="notransition">

<script src="/js/theme.js"></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="http://localhost:1313/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title>Home</title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/">
                        home
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/posts/">
                        posts
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/notes/">
                        notes
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/readings/">
                        readings
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/about">
                        about
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
                
                
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title"></h1>
                
            </header>
            
            <div class="page-content">
                <h2 id="selinux-terminology">SELinux Terminology</h2>
<ul>
<li>
<p>Implementation of the Mandatory Access Control (MAC) architecture</p>
<ul>
<li>developed by the U.S. National Security Agency (NSA)</li>
<li>flexible, enriched, and granular security controls in Linux.</li>
<li>integrated into the Linux kernel as a set of patches using the Linux Security Modules (LSM) framework that
<ul>
<li>allows the kernel to support various security implementations</li>
</ul>
</li>
<li>provides an added layer of protection above and beyond the standard Linux Discretionary Access Control (DAC) security architecture.</li>
<li>DAC includes:
<ul>
<li>traditional file and directory permissions</li>
<li>extended attribute settings</li>
<li>setuid/setgid bits</li>
<li>su/sudo privileges</li>
<li>etc.</li>
</ul>
</li>
<li>Limits the ability of a <strong>subject</strong> (Linux user or process) to access an <strong>object</strong> (file, directory, file system, device, network interface/connection, port, pipe, socket, etc.)
<ul>
<li>To reduce or eliminate the potential damage the subject may be able to inflict on the system if compromised.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>MAC controls</strong></p>
<ul>
<li>Fine-grained</li>
<li>Protect other services in the event one service is negotiated.</li>
<li>Example:
<ul>
<li>If the HTTP service process is compromised, the attacker can only damage the files the hacked process will have access to, and not the other processes running on the system, or the objects the other processes will have access to.</li>
</ul>
</li>
<li>To ensure this coarse-grained control, MAC uses a set of defined authorization rules called <strong>policy</strong> to examine security attributes associated with subjects and objects when a subject tries to access an object, and decides whether to permit the access attempt.</li>
<li>These attributes are stored in <strong>contexts</strong> (a.k.a. <strong>labels</strong>), and are applied to both subjects and objects.</li>
</ul>
</li>
<li>
<p>SELinux decisions are stored in a special cache area called <strong>Access</strong>
<strong>Vector Cache</strong> (<strong>AVC</strong>).</p>
</li>
<li>
<p>This cache area is checked for each access attempt by a process to determine whether the access attempt was previously allowed.</p>
</li>
<li>
<p>With this mechanism in place, SELinux does not have to check the policy ruleset repeatedly, thus improving performance.</p>
</li>
<li>
<p>SELinux is enabled by default</p>
<ul>
<li>Confines processes to the bare minimum privileges that they need to function.</li>
</ul>
</li>
</ul>
<h3 id="key-terms">Key Terms</h3>
<p><strong>Subject</strong></p>
<ul>
<li>Any user or process that accesses an object.</li>
<li>Examples:
<ul>
<li><em>system_u</em> for the SELinux system user</li>
<li><em>unconfined_u</em> for subjects that are not bound by the SELinux policy</li>
</ul>
</li>
<li>Stored in field 1 of the context.</li>
</ul>
<p><strong>Object</strong></p>
<ul>
<li>A resource, such as a file, directory, hardware device, network interface/connection, port, pipe, or socket, that a subject accesses.</li>
<li>Examples:
<ul>
<li><em>object_r</em> for general objects</li>
<li><em>system_r</em> for system-owned objects</li>
<li><em>unconfined_r</em> for objects that are not bound by the SELinux policy.</li>
</ul>
</li>
</ul>
<p><strong>Access</strong></p>
<ul>
<li>An action performed by the subject on an object.</li>
<li>Examples:
<ul>
<li>creating, reading, or updating a file</li>
<li>creating or navigating a directory</li>
<li>accessing a network port or socket</li>
</ul>
</li>
</ul>
<p><strong>Policy</strong></p>
<ul>
<li>A defined ruleset that is enforced system-wide</li>
<li>Used to analyze security attributes assigned to subjects and objects.</li>
<li>Referenced to decide whether to permit a subject&rsquo;s access attempt to an object, or a subject&rsquo;s attempt to interact with another subject.</li>
<li>The default behavior of SELinux in the absence of a rule is to deny the access.</li>
<li>Standard preconfigured policies:
<ul>
<li><strong>targeted</strong> (default)
<ul>
<li>Any process that is targeted runs in a confined domain</li>
<li>Any process that is not targeted runs in an unconfined domain.</li>
<li>Example:
<ul>
<li>SELinux runs logged-in users in the unconfined domain, and the httpd process in a confined domain by default.</li>
<li>Any subject running unconfined is more vulnerable than the one running confined.</li>
</ul>
</li>
</ul>
</li>
<li><strong>mls</strong>
<ul>
<li>places tight security controls at deeper levels.</li>
</ul>
</li>
<li><strong>minimum</strong>
<ul>
<li>light version of the targeted policy</li>
<li>designed to protect only selected processes.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>Context</strong> (label)</p>
<ul>
<li>A tag to store security attributes for subjects and objects.</li>
<li>Every subject and object has a context assigned</li>
<li>Consists of a SELinux user, role, type (or domain), and sensitivity level.</li>
<li>Used by SELinux  to make access control decisions.</li>
</ul>
<p><strong>Labeling</strong></p>
<ul>
<li>Mapping of files with their stored contexts.</li>
</ul>
<p><strong>SELinux User</strong></p>
<ul>
<li>Several predefined SELinux user identities that are authorized for a particular set of roles.</li>
<li>Linux user to SELinux user identity mapping to place SELinux user restrictions on Linux users.</li>
<li>Controls what roles and levels a process (with a particular SELinux user identity) can enter.</li>
<li>Example:
<ul>
<li>A Linux user cannot run the <code>su</code> and <code>sudo</code> commands or the programs located in their home directories if they are mapped to the SELinux user <em>user_u</em>.</li>
</ul>
</li>
</ul>
<p><strong>Role</strong></p>
<ul>
<li>An attribute of the <strong>Role-Based Access Control (RBAC)</strong> security model that is part of SELinux.</li>
<li>Classifies who (subject) is allowed to access what (domains or types).</li>
<li>SELinux users are authorized for roles, and roles are authorized for domains and types.</li>
<li>Each subject has an associated role to ensure that the system and user processes are separated.</li>
<li>A subject can transition into a new role to gain access to other domains and types.</li>
<li>Examples:
<ul>
<li><em>user_r</em> for ordinary users</li>
<li><em>sysadm_r</em> for administrators</li>
<li><em>system_r</em> for processes that initiate under the <em>system_r</em> role</li>
</ul>
</li>
<li>Stored in field 2 of the context.</li>
</ul>
<p><strong>Type Enforcement</strong> (TE)</p>
<ul>
<li>Identifies and limits a subject&rsquo;s ability to access domains for processes, and types for files.</li>
<li>References the contexts of the subjects and objects for this enforcement.</li>
</ul>
<p><strong>Type</strong></p>
<ul>
<li>Attribute of type enforcement.</li>
<li>Group of objects based on uniformity in their security requirements.</li>
<li>Objects such as files and directories with common security requirements, are grouped within a specific type.</li>
<li>Examples:
<ul>
<li><em>user_home_dir_t</em> for objects located in user home directories</li>
<li><em>usr_t</em> for most objects stored in the /usr directory.</li>
</ul>
</li>
<li>Stored in field 3 of a file context.</li>
</ul>
<p><strong>Domain</strong></p>
<ul>
<li>Determines the type of access that a process has.</li>
<li>Processes with common security requirements are grouped within a specific domain type, and they run confined within that domain.</li>
<li>Examples:
<ul>
<li><em>init_t</em> for the systemd process</li>
<li><em>firewalld_t</em> for the firewalld process</li>
<li><em>unconfined_t</em> for all processes that are not bound by SELinux policy.</li>
</ul>
</li>
<li>Stored in field 3 of a process context.</li>
</ul>
<p><strong>Rules</strong></p>
<ul>
<li>Outline how types can access each other, domains can access types, and domains can access each other.</li>
</ul>
<p><strong>Level</strong></p>
<ul>
<li>An attribute of <strong>Multi-Level Security (MLS)</strong> and <strong>Multi-Category</strong> <strong>Security (MCS)</strong>.</li>
<li>Pair of <em>sensitivity:category</em> values that defines the level of security in the context.</li>
<li><em>category</em>may be defined as a single value or a range of values, such as c0.c4 to represent c0 through c4.</li>
<li>In RHEL 9, the targeted policy is used as the default, which enforces <strong>MCS</strong> (MCS supports only one sensitivity level (s0) with 0 to 1023 different categories).</li>
</ul>
<h2 id="selinux-contexts">SELinux Contexts</h2>
<h3 id="selinux-contexts-for-users">SELinux Contexts for Users</h3>
<ul>
<li>SELinux contexts define security attributes placed on subjects and objects.</li>
<li>Each context contains a type and a security level with subject and object information.</li>
</ul>
<p>Use the <code>id</code> command with the <code>-Z</code> option to view the context set on Linux users:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># id -Z</span>
</span></span><span class="line"><span class="cl">unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
</span></span></code></pre></div><p>Output:</p>
<ul>
<li>
<p>Mapped to the SELinux unconfined_u user</p>
</li>
<li>
<p>No SELinux restrictions placed on this user.</p>
</li>
<li>
<p>All Linux users, including root, run unconfined by default, (full system access)</p>
</li>
<li>
<p>Seven confined user identities with restricted access to objects.</p>
<ul>
<li>Mapped to Linux users via SELinux policy.</li>
<li>Helps safeguard the system from potential damage that Linux users might inflict on the system.</li>
</ul>
</li>
</ul>
<p>Use the <code>seinfo</code> query command to list the SELinux users; however, the <code>setools-console</code> software package must be installed before doing so.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># seinfo -u</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Users: <span class="m">8</span>
</span></span><span class="line"><span class="cl">   guest_u
</span></span><span class="line"><span class="cl">   root
</span></span><span class="line"><span class="cl">   staff_u
</span></span><span class="line"><span class="cl">   sysadm_u
</span></span><span class="line"><span class="cl">   system_u
</span></span><span class="line"><span class="cl">   unconfined_u
</span></span><span class="line"><span class="cl">   user_u
</span></span><span class="line"><span class="cl">   xguest_u
</span></span></code></pre></div><p>Use the <code>semanage</code> command to view the mapping between Linux and SELinux users:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># semanage login -l</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Login Name           SELinux User         MLS/MCS Range        Service
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">__default__          unconfined_u         s0-s0:c0.c1023       *
</span></span><span class="line"><span class="cl">root                 unconfined_u         s0-s0:c0.c1023       *
</span></span></code></pre></div><p><strong>MLS/MCS Range</strong></p>
<ul>
<li>Associated security level and the context for the Linux user (the * represents all services).</li>
<li>By default, all non-root Linux users are represented as <code>__default__</code>, which is mapped to the unconfined_u user in the policy.</li>
</ul>
<h3 id="selinux-contexts-for-processes">SELinux Contexts for Processes</h3>
<p>Determine the context for processes using the <code>ps</code> command with
the <code>-Z</code> flag:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># ps -eZ | head -2</span>
</span></span><span class="line"><span class="cl">LABEL                               PID TTY          TIME CMD
</span></span><span class="line"><span class="cl">system_u:system_r:init_t:s0           <span class="m">1</span> ?        00:00:02 systemd
</span></span></code></pre></div><p>Output:</p>
<ul>
<li>
<p>The subject <em>system_u</em> is a SELinux username (mapped to Linux user root)</p>
</li>
<li>
<p>Object is <em>system_r</em></p>
</li>
<li>
<p>Domain <em>init_t</em> reveals the type of protection applied to the process.</p>
</li>
<li>
<p>Level of security <code>s0</code></p>
</li>
<li>
<p>A process that is unprotected will run in the unconfined_t domain.</p>
</li>
</ul>
<h3 id="selinux-contexts-for-files">SELinux Contexts for Files</h3>
<p><code>ls -Z</code></p>
<ul>
<li>View context for files and directories.</li>
</ul>
<p>Show the four attributes set on the /etc/passwd file:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># ls -lZ /etc/passwd</span>
</span></span><span class="line"><span class="cl">-rw-r--r--. <span class="m">1</span> root root system_u:object_r:passwd_file_t:s0 <span class="m">2806</span> Jul <span class="m">19</span> 21:54 /etc/passwd
</span></span></code></pre></div><ul>
<li>Subject <em>system_u</em></li>
<li>Object <em>object_r</em></li>
<li>Type <code>passwd_file_t</code></li>
<li>Security level <code>s0</code> for the passwd file.</li>
</ul>
<p><em>/etc/selinux/targeted/contexts/files/file_contexts</em>
<em>/etc/selinux/targeted/contexts/files/file_contexts.local</em></p>
<ul>
<li>Stores contexts for system-installed and user-created files.</li>
<li>Policy files.</li>
<li>Can be updated using the <code>semanage</code> command.</li>
</ul>
<h3 id="copying-moving-and-archiving-files-with-selinux-contexts">Copying, Moving, and Archiving Files with SELinux Contexts</h3>
<ul>
<li>All files in RHEL are labeled with an SELINUX security context by default.</li>
<li>New files inherit the parent directory&rsquo;s context at the time of creation.</li>
</ul>
<p>Rules for copy move and archive:</p>
<ol>
<li>
<p>If a file is copied to a different directory, the destination file will receive the destination directory&rsquo;s context, unless the <code>--preserve=context</code> switch is specified with the <code>cp</code> command to retain the source file&rsquo;s original context.</p>
</li>
<li>
<p>If a copy operation overwrites the destination file in the same or different directory, the file being copied will receive the context of the overwritten file, unless the <code>--preserve=context</code> switch is specified with the <code>cp</code> command to preserve the source file&rsquo;s original context.</p>
</li>
<li>
<p>If a file is moved to the same or different directory, the SELinux context will remain intact, which may differ from the destination directory&rsquo;s context.</p>
</li>
<li>
<p>If a file is archived with the tar command, use the <code>--selinux</code> option to preserve the context.</p>
</li>
</ol>
<h3 id="selinux-contexts-for-ports">SELinux Contexts for Ports</h3>
<p>View attributes for network ports with the <code>semanage</code> command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># semanage port -l | head -7</span>
</span></span><span class="line"><span class="cl">SELinux Port Type              Proto    Port Number
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">afs3_callback_port_t           tcp      <span class="m">7001</span>
</span></span><span class="line"><span class="cl">afs3_callback_port_t           udp      <span class="m">7001</span>
</span></span><span class="line"><span class="cl">afs_bos_port_t                 udp      <span class="m">7007</span>
</span></span><span class="line"><span class="cl">afs_fs_port_t                  tcp      <span class="m">2040</span>
</span></span><span class="line"><span class="cl">afs_fs_port_t                  udp      7000, <span class="m">7005</span>
</span></span></code></pre></div><ul>
<li>By default, SELinux allows services to listen on a restricted set of network ports only.</li>
</ul>
<h2 id="domain-transitioning">Domain Transitioning</h2>
<ul>
<li>SELinux allows a process running in one domain to enter another domain to execute an application that is restricted to run in that domain only.</li>
<li>A rule must exist in the policy to support such transition.</li>
<li><strong>entrypoint</strong>
<ul>
<li>Permission setting</li>
<li>control processes that can transition into another domain.</li>
</ul>
</li>
</ul>
<p>Example:
What happens when a Linux user attempts to change their password using the <code>/usr/bin/passwd</code> command.</p>
<p>The <code>passwd</code> command is labeled with the passwd_exec_t type:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># ls -lZ /usr/bin/passwd</span>
</span></span><span class="line"><span class="cl">-rwsr-xr-x. <span class="m">1</span> root root system_u:object_r:passwd_exec_t:s0 <span class="m">32648</span> Aug <span class="m">10</span>  <span class="m">2021</span> /usr/bin/passwd
</span></span></code></pre></div><p>The <code>passwd</code> command requires access to the <code>/etc/shadow</code> file in order to modify a user password. The shadow file has a different type set on it
(<em>shadow_t</em>):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">**<span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># ls -lZ /etc/shadow</span>
</span></span><span class="line"><span class="cl">----------. <span class="m">1</span> root root system_u:object_r:shadow_t:s0 <span class="m">2756</span> Jul <span class="m">19</span> 21:54 /etc/shadow
</span></span></code></pre></div><ul>
<li>The SELinux policy has rules that specifically allow processes running in domain <em>passwd_t</em> to read and modify the files with type <em>shadow_t</em>, andm allow them <strong>entrypoint</strong> permission into domain <em>passwd_exec_t</em>.</li>
<li>This rule enables the user&rsquo;s shell process executing the <code>passwd</code> command to switch into the <em>passwd_t</em> domain and update the shadow file.</li>
</ul>
<p>Open two terminal windows. In window 1, issue the passwd command as
user1 and wait at the prompt:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>user1@server30 root<span class="o">]</span>$ passwd
</span></span><span class="line"><span class="cl">Changing password <span class="k">for</span> user user1.
</span></span><span class="line"><span class="cl">Current password: 
</span></span></code></pre></div><p>In window 2, run the ps command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># ps -eZ | grep passwd</span>
</span></span><span class="line"><span class="cl">unconfined_u:unconfined_r:passwd_t:s0-s0:c0.c1023 <span class="m">13001</span> pts/1 00:00:00 passwd
</span></span></code></pre></div><ul>
<li>The <code>passwd</code> command (process) transitioned into the <em>passwd_t</em> domain to change the user password.</li>
</ul>
<h2 id="selinux-booleans">SELinux Booleans</h2>
<ul>
<li>on/off switches that SELinux uses to determine whether to permit an action.</li>
<li>Activate or deactivate certain rule in the SELinux policy immediately and without the need to recompile or reload the policy.</li>
<li>For instance, the <em>ftpd_anon_write</em> Boolean can be turned on to enable anonymous users to upload files.</li>
<li>This privilege can be revoked by turning this Boolean off.</li>
<li>Boolean values are stored in virtual files located in <em>/sys/fs/selinux/booleans/</em>.</li>
<li>The filenames match the Boolean names.</li>
</ul>
<p>A sample listing of this directory is provided below:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># ls -l /sys/fs/selinux/booleans/ | head -7</span>
</span></span><span class="line"><span class="cl">total <span class="m">0</span>
</span></span><span class="line"><span class="cl">-rw-r--r--. <span class="m">1</span> root root <span class="m">0</span> Jul <span class="m">23</span> 04:44 abrt_anon_write
</span></span><span class="line"><span class="cl">-rw-r--r--. <span class="m">1</span> root root <span class="m">0</span> Jul <span class="m">23</span> 04:44 abrt_handle_event
</span></span><span class="line"><span class="cl">-rw-r--r--. <span class="m">1</span> root root <span class="m">0</span> Jul <span class="m">23</span> 04:44 abrt_upload_watch_anon_write
</span></span><span class="line"><span class="cl">-rw-r--r--. <span class="m">1</span> root root <span class="m">0</span> Jul <span class="m">23</span> 04:44 antivirus_can_scan_system
</span></span><span class="line"><span class="cl">-rw-r--r--. <span class="m">1</span> root root <span class="m">0</span> Jul <span class="m">23</span> 04:44 antivirus_use_jit
</span></span><span class="line"><span class="cl">-rw-r--r--. <span class="m">1</span> root root <span class="m">0</span> Jul <span class="m">23</span> 04:44 auditadm_exec_content
</span></span></code></pre></div><ul>
<li>
<p>The manual pages of the Booleans are available through the <code>selinux-policy-doc</code> package.</p>
</li>
<li>
<p>Once installed, use the <code>-K</code> option with the <code>man</code> command to bring the pages up for a specific Boolean.</p>
</li>
<li>
<p>For instance, issue <code>man -K abrt_anon_write</code> to view the manual pages for the <code>abrt_anon_write</code> Boolean.</p>
</li>
<li>
<p>Can be viewed, and flipped temporarily or for permanence.</p>
</li>
<li>
<p>New value takes effect right away.</p>
</li>
<li>
<p>Temporary changes are stored as a &ldquo;1&rdquo; or &ldquo;0&rdquo; in the corresponding Boolean file in the <em>/sys/fs/selinux/booleans/</em></p>
</li>
<li>
<p>Permanent changes are saved in the policy database.</p>
</li>
</ul>
<h2 id="selinux-administration">SELinux Administration</h2>
<ul>
<li>Controlling the activation mode, checking operational status, setting security contexts on subjects and objects, and switching Boolean values.</li>
</ul>
<p>Utilities and the commands they provide</p>
<ul>
<li><code>libselinux-utils</code>
<ul>
<li><code>getenforce</code></li>
<li><code>getenforce</code></li>
<li><code>getsebool</code></li>
</ul>
</li>
<li><code>policycoreutils</code>
<ul>
<li><code>sestatus</code></li>
<li><code>setsebool</code></li>
<li><code>restorecon</code></li>
</ul>
</li>
<li><code>policycoreutils-python-utils</code>
<ul>
<li><code>semanage</code></li>
</ul>
</li>
<li><code>setools-console</code>
<ul>
<li><code>seinfo</code></li>
<li><code>sesearch</code></li>
</ul>
</li>
</ul>
<p><strong>SELinux Alert Browser</strong></p>
<ul>
<li>
<p>Graphical tool for viewing alerts and debugging SELinux issues.</p>
</li>
<li>
<p>Part of the <code>setroubleshoot-server</code> package.</p>
</li>
<li>
<p>In order to fully manage SELinux, you need to ensure that all these packages are installed on the system.</p>
</li>
</ul>
<h3 id="management-commands">Management Commands</h3>
<p>SELinux delivers a variety of commands for effective administration.
Table 20-1 lists and describes the commands mentioned above plus a few
more under various management categories.</p>
<p><strong>Mode Management</strong></p>
<p><code>getenforce</code></p>
<ul>
<li>Displays the current mode of operation</li>
</ul>
<p><code>grubby</code></p>
<ul>
<li>Updates and displays information about the configuration files for the grub2 boot loader</li>
</ul>
<p><code>sestatus</code></p>
<ul>
<li>Shows SELinux runtime status and Boolean values</li>
</ul>
<p><code>setenforce</code></p>
<ul>
<li>Switches the operating mode between enforcing and permissive temporarily</li>
</ul>
<p><strong>Context Management</strong></p>
<p><code>chcon</code></p>
<ul>
<li>Changes context on files (changes do not survive file system relabeling)</li>
</ul>
<p><code>restorecon</code></p>
<ul>
<li>Restores default contexts on files by referencing the files in  <em>/etc/selinux/targeted/contexts/files/</em></li>
</ul>
<p><code>semanage </code></p>
<ul>
<li>Changes context on files with the <code>fcontext</code> subcommand (changes survive file system relabeling)</li>
</ul>
<p><strong>Policy Management</strong></p>
<p><code>seinfo </code></p>
<ul>
<li>Provides information on policy components</li>
</ul>
<p><code>semanage</code></p>
<ul>
<li>Manages policy database</li>
</ul>
<p><code>sesearch</code></p>
<ul>
<li>Searches rules in the policy database</li>
</ul>
<p><strong>Boolean Management</strong></p>
<p><code>getsebool</code></p>
<ul>
<li>Displays Booleans and their current settings.</li>
</ul>
<p><code>setsebool</code></p>
<ul>
<li>Modifies Boolean values temporarily, or in the policy database.</li>
</ul>
<p><code>semanage</code></p>
<ul>
<li>Modifies Boolean values in the policy database with the <code>boolean</code>subcommand.</li>
</ul>
<p><strong>Troubleshooting</strong></p>
<p><code>sealert</code></p>
<ul>
<li>The graphical troubleshooting tool</li>
</ul>
<h3 id="viewing-and-controlling-selinux-operational-state">Viewing and Controlling SELinux Operational State</h3>
<p><em>/etc/selinux/config</em></p>
<ul>
<li>One of the key configuration files that controls the SELinux operational state, and sets its default type
The default content of the file is displayed below:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># cat /etc/selinux/config</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># This file controls the state of SELinux on the system.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># SELINUX= can take one of these three values:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     enforcing - SELinux security policy is enforced.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     permissive - SELinux prints warnings instead of enforcing.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     disabled - No SELinux policy is loaded.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># See also:</span>
</span></span><span class="line"><span class="cl"><span class="c1"># https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_selinux/changing-selinux-states-and-modes_using-selinux#changing-selinux-modes-at-boot-time_changing-selinux-states-and-modes</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># NOTE: Up to RHEL 8 release included, SELINUX=disabled would also</span>
</span></span><span class="line"><span class="cl"><span class="c1"># fully disable SELinux during boot. If you need a system with SELinux</span>
</span></span><span class="line"><span class="cl"><span class="c1"># fully disabled instead of SELinux running with no policy loaded, you</span>
</span></span><span class="line"><span class="cl"><span class="c1"># need to pass selinux=0 to the kernel command line. You can use grubby</span>
</span></span><span class="line"><span class="cl"><span class="c1"># to persistently set the bootloader to boot with selinux=0:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1">#    grubby --update-kernel ALL --args selinux=0</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1"># To revert back to SELinux enabled:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="c1">#    grubby --update-kernel ALL --remove-args selinux</span>
</span></span><span class="line"><span class="cl"><span class="c1">#</span>
</span></span><span class="line"><span class="cl"><span class="nv">SELINUX</span><span class="o">=</span>enforcing
</span></span><span class="line"><span class="cl"><span class="c1"># SELINUXTYPE= can take one of these three values:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     targeted - Targeted processes are protected,</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     minimum - Modification of targeted policy. Only selected processes are protected.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#     mls - Multi Level Security protection.</span>
</span></span><span class="line"><span class="cl"><span class="nv">SELINUXTYPE</span><span class="o">=</span>targeted
</span></span></code></pre></div><p>Directives:</p>
<p><strong>SELINUX</strong></p>
<ul>
<li>Sets the activation mode for SELinux.</li>
<li><em>Enforcing</em> activates it and allows or denies actions based on the policy rules.</li>
<li><em>Permissive</em> activates SELinux, but permits all actions.
<ul>
<li>It records all security violations.</li>
<li>Useful for troubleshooting and developing or tuning the policy.</li>
</ul>
</li>
<li>The third option is to completely turn SELinux off. When running in enforcing mode</li>
</ul>
<p><strong>SELINUXTYPE</strong></p>
<ul>
<li>Dictates the type of policy to be enforced.</li>
<li>Default is targeted.</li>
</ul>
<p>Determine the current operating mode:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># getenforce</span>
</span></span><span class="line"><span class="cl">Enforcing
</span></span></code></pre></div><p>Change the state to permissive and verify:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># setenforce permissive</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># getenforce</span>
</span></span><span class="line"><span class="cl">Permissive
</span></span></code></pre></div><ul>
<li>Can also &ldquo;0&rdquo; for permissive and a &ldquo;1&rdquo; for enforcing.</li>
<li>Changes will be lost at the next system reboot.</li>
<li>Edit  <em>/etc/selinux/config</em> <strong>SELINUX</strong> directive to the desired mode for persistence.</li>
</ul>
<p>EXAM TIP: You may switch SELinux to permissive for troubleshooting a
non-functioning service. Don&rsquo;t forget to change it back to enforcing
when the issue is resolved.</p>
<p>Disable SELinux persistently:
<code>[root@server30 ~]# grubby --update-kernel ALL --args selinux=0</code></p>
<ul>
<li>Appends the selinux=0 setting to the end of the &ldquo;options&rdquo; line in the bootloader configuration file located in the /boot/loader/entries directory:</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># cat /boot/loader/entries/dcb323fab47049e8b89dae2ae00d41e8-5.14.0-427.26.1.el9_4.x86_64.conf </span>
</span></span><span class="line"><span class="cl">title Red Hat Enterprise Linux <span class="o">(</span>5.14.0-427.26.1.el9_4.x86_64<span class="o">)</span> 9.4 <span class="o">(</span>Plow<span class="o">)</span>
</span></span><span class="line"><span class="cl">version 5.14.0-427.26.1.el9_4.x86_64
</span></span><span class="line"><span class="cl">linux /vmlinuz-5.14.0-427.26.1.el9_4.x86_64
</span></span><span class="line"><span class="cl">initrd /initramfs-5.14.0-427.26.1.el9_4.x86_64.img <span class="nv">$tuned_initrd</span>
</span></span><span class="line"><span class="cl">options <span class="nv">root</span><span class="o">=</span>/dev/mapper/rhel-root ro <span class="nv">crashkernel</span><span class="o">=</span>1G-4G:192M,4G-64G:256M,64G-:512M <span class="nv">resume</span><span class="o">=</span>/dev/mapper/rhel-swap rd.lvm.lv<span class="o">=</span>rhel/root rd.lvm.lv<span class="o">=</span>rhel/swap rhgb quiet <span class="nv">$tuned_params</span> <span class="nv">selinux</span><span class="o">=</span><span class="m">0</span>
</span></span><span class="line"><span class="cl">grub_users <span class="nv">$grub_users</span>
</span></span><span class="line"><span class="cl">grub_arg --unrestricted
</span></span><span class="line"><span class="cl">grub_class rhel
</span></span></code></pre></div><p>Revert the above:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># grubby --update-kernel ALL --remove-args selinux=0</span>
</span></span></code></pre></div><h3 id="querying-status">Querying Status</h3>
<p><code>sestatus</code> Command</p>
<ul>
<li>View the current runtime status of SELinux</li>
<li>Displays the location of principal directories, the policy in effect, and the activation mode.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># sestatus</span>
</span></span><span class="line"><span class="cl">SELinux status:                 enabled
</span></span><span class="line"><span class="cl">SELinuxfs mount:                /sys/fs/selinux
</span></span><span class="line"><span class="cl">SELinux root directory:         /etc/selinux
</span></span><span class="line"><span class="cl">Loaded policy name:             targeted
</span></span><span class="line"><span class="cl">Current mode:                   permissive
</span></span><span class="line"><span class="cl">Mode from config file:          enforcing
</span></span><span class="line"><span class="cl">Policy MLS status:              enabled
</span></span><span class="line"><span class="cl">Policy deny_unknown status:     allowed
</span></span><span class="line"><span class="cl">Memory protection checking:     actual <span class="o">(</span>secure<span class="o">)</span>
</span></span><span class="line"><span class="cl">Max kernel policy version:      <span class="m">33</span>
</span></span></code></pre></div><p><code>-v </code></p>
<ul>
<li>Report on security contexts set on files and processes, as listed in
<em>/etc/sestatus.conf</em> .</li>
<li>Reports the contexts for the current process (Current context) and the init (systemd) process (Init context) under Process Contexts.</li>
<li>Reveals the file contexts for the controlling terminal and associated files under File Contexts.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># cat /etc/sestatus.conf</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>files<span class="o">]</span>
</span></span><span class="line"><span class="cl">/etc/passwd
</span></span><span class="line"><span class="cl">/etc/shadow
</span></span><span class="line"><span class="cl">/bin/bash
</span></span><span class="line"><span class="cl">/bin/login
</span></span><span class="line"><span class="cl">/bin/sh
</span></span><span class="line"><span class="cl">/sbin/agetty
</span></span><span class="line"><span class="cl">/sbin/init
</span></span><span class="line"><span class="cl">/sbin/mingetty
</span></span><span class="line"><span class="cl">/usr/sbin/sshd
</span></span><span class="line"><span class="cl">/lib/libc.so.6
</span></span><span class="line"><span class="cl">/lib/ld-linux.so.2
</span></span><span class="line"><span class="cl">/lib/ld.so.1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>process<span class="o">]</span>
</span></span><span class="line"><span class="cl">/sbin/mingetty
</span></span><span class="line"><span class="cl">/sbin/agetty
</span></span><span class="line"><span class="cl">/usr/sbin/sshd
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># sestatus -v</span>
</span></span><span class="line"><span class="cl">SELinux status:                 enabled
</span></span><span class="line"><span class="cl">SELinuxfs mount:                /sys/fs/selinux
</span></span><span class="line"><span class="cl">SELinux root directory:         /etc/selinux
</span></span><span class="line"><span class="cl">Loaded policy name:             targeted
</span></span><span class="line"><span class="cl">Current mode:                   permissive
</span></span><span class="line"><span class="cl">Mode from config file:          enforcing
</span></span><span class="line"><span class="cl">Policy MLS status:              enabled
</span></span><span class="line"><span class="cl">Policy deny_unknown status:     allowed
</span></span><span class="line"><span class="cl">Memory protection checking:     actual <span class="o">(</span>secure<span class="o">)</span>
</span></span><span class="line"><span class="cl">Max kernel policy version:      <span class="m">33</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Process contexts:
</span></span><span class="line"><span class="cl">Current context:                unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
</span></span><span class="line"><span class="cl">Init context:                   system_u:system_r:init_t:s0
</span></span><span class="line"><span class="cl">/sbin/agetty                    system_u:system_r:getty_t:s0-s0:c0.c1023
</span></span><span class="line"><span class="cl">/usr/sbin/sshd                  system_u:system_r:sshd_t:s0-s0:c0.c1023
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">File contexts:
</span></span><span class="line"><span class="cl">Controlling terminal:           unconfined_u:object_r:user_devpts_t:s0
</span></span><span class="line"><span class="cl">/etc/passwd                     system_u:object_r:passwd_file_t:s0
</span></span><span class="line"><span class="cl">/etc/shadow                     system_u:object_r:shadow_t:s0
</span></span><span class="line"><span class="cl">/bin/bash                       system_u:object_r:shell_exec_t:s0
</span></span><span class="line"><span class="cl">/bin/login                      system_u:object_r:login_exec_t:s0
</span></span><span class="line"><span class="cl">/bin/sh                         system_u:object_r:bin_t:s0 -&gt; system_u:object_r:shell_exec_t:s0
</span></span><span class="line"><span class="cl">/sbin/agetty                    system_u:object_r:getty_exec_t:s0
</span></span><span class="line"><span class="cl">/sbin/init                      system_u:object_r:bin_t:s0 -&gt; system_u:object_r:init_exec_t:s0
</span></span><span class="line"><span class="cl">/usr/sbin/sshd                  system_u:object_r:sshd_exec_t:s0
</span></span></code></pre></div><h3 id="lab-modify-selinux-file-context">Lab: Modify SELinux File Context</h3>
<ul>
<li>Create a directory sedir1 under /tmp and a file sefile1 under sedir1.</li>
<li>Check the context on the directory and file.</li>
<li>Change the SELinux user and type to user_u and public_content_t on both and verify.</li>
</ul>
<p>1. Create the hierarchy sedir1/sefile1 under /tmp:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># cd /tmp</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># mkdir sedir1</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># touch sedir1/sefile1</span>
</span></span></code></pre></div><p>2. Determine the context on the new directory and file:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># ls -ldZ sedir1</span>
</span></span><span class="line"><span class="cl">drwxr-xr-x. <span class="m">2</span> root root unconfined_u:object_r:user_tmp_t:s0 <span class="m">21</span> Jul <span class="m">28</span> 15:12 sedir1
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># ls -ldZ sedir1/sefile1</span>
</span></span><span class="line"><span class="cl">-rw-r--r--. <span class="m">1</span> root root unconfined_u:object_r:user_tmp_t:s0 <span class="m">0</span> Jul <span class="m">28</span> 15:12 sedir1/sefile1
</span></span></code></pre></div><p>3. Modify the SELinux user (<code>-u</code>) on the directory to <code>user_u</code> and type
(<code>-t</code>) to <code>public_content_t</code> recursively (<code>-R</code>) with the <code>chcon</code> command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># chcon -vu user_u -t public_content_t sedir1 -R</span>
</span></span><span class="line"><span class="cl">changing security context of <span class="s1">&#39;sedir1/sefile1&#39;</span>
</span></span><span class="line"><span class="cl">changing security context of <span class="s1">&#39;sedir1&#39;</span>
</span></span></code></pre></div><p>4. Validate the new context:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># ls -ldZ sedir1</span>
</span></span><span class="line"><span class="cl">drwxr-xr-x. <span class="m">2</span> root root user_u:object_r:public_content_t:s0 <span class="m">21</span> Jul <span class="m">28</span> 15:12 sedir1
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># ls -ldZ sedir1/sefile1</span>
</span></span><span class="line"><span class="cl">-rw-r--r--. <span class="m">1</span> root root user_u:object_r:public_content_t:s0 <span class="m">0</span> Jul <span class="m">28</span> 15:12 sedir1/sefile1
</span></span></code></pre></div><h3 id="lab-add-and-apply-file-context">Lab: Add and Apply File Context</h3>
<ul>
<li>Add the current context on sedir1 to the SELinux policy database to ensure a relabeling will not reset it to its previous value</li>
<li>Change the context on the directory to some random values.</li>
<li>Restore the default context from the policy database back to the directory recursively.</li>
</ul>
<ol>
<li>Determine the current context:</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># ls -ldZ sedir1</span>
</span></span><span class="line"><span class="cl">drwxr-xr-x. <span class="m">2</span> root root user_u:object_r:public_content_t:s0 <span class="m">21</span> Jul <span class="m">28</span> 15:12 sedir1
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># ls -ldZ sedir1/sefile1</span>
</span></span><span class="line"><span class="cl">-rw-r--r--. <span class="m">1</span> root root user_u:object_r:public_content_t:s0 <span class="m">0</span> Jul <span class="m">28</span> 15:12 sedir1/sefile1
</span></span></code></pre></div><ol start="2">
<li>Add (-a) the directory recursively to the policy database using the <code>semanage</code> command with the <code>fcontext</code> subcommand:</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># semanage fcontext -a -s user_u -t public_content_t &#39;/tmp/sedir1(/.*)?&#39;</span>
</span></span></code></pre></div><ul>
<li>The regular expression (/.*)? instructs the command to include all files and subdirectories under /tmp/sedir1.
<ul>
<li>Needed only if recursion is required.</li>
</ul>
</li>
</ul>
<p>The above command added the context to the <em>/etc/selinux/targeted/contexts/files/file_contexts.local file</em>.</p>
<ol start="3">
<li>Validate the addition by listing (-l) the recent changes (-C) in the
policy database:</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># semanage fcontext -Cl | grep sedir</span>
</span></span><span class="line"><span class="cl">/tmp/sedir1<span class="o">(</span>/.*<span class="o">)</span>?                                  all files          user_u:object_r:public_content_t:s0 
</span></span></code></pre></div><ol start="4">
<li>Change the current context on sedir1 to something random (staff_u/etc_t) with the <code>chcon</code> command:</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@server30 tmp<span class="o">]</span><span class="c1"># chcon -vu staff_u -t etc_t sedir1 -R</span>
</span></span><span class="line"><span class="cl">changing security context of <span class="s1">&#39;sedir1/sefile1&#39;</span>
</span></span><span class="line"><span class="cl">changing security context of <span class="s1">&#39;sedir1&#39;</span>
</span></span></code></pre></div><ol start="5">
<li>The security context is changed successfully. Confirm with the <code>ls</code>
command:</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># ls -ldZ sedir1 ; ls -lZ sedir1/sefile1</span>
</span></span><span class="line"><span class="cl">drwxr-xr-x. <span class="m">2</span> root root staff_u:object_r:etc_t:s0 <span class="m">21</span> Jul <span class="m">28</span> 15:12 sedir1
</span></span><span class="line"><span class="cl">-rw-r--r--. <span class="m">1</span> root root staff_u:object_r:etc_t:s0 <span class="m">0</span> Jul <span class="m">28</span> 15:12 sedir1/sefile1
</span></span></code></pre></div><ol start="6">
<li>Reinstate the context on the sedir1 directory recursively (<code>-R</code>) as stored in the policy database using the <code>restorecon</code> command:</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># restorecon -Rv sedir1</span>
</span></span><span class="line"><span class="cl">Relabeled /tmp/sedir1 from staff_u:object_r:etc_t:s0 to staff_u:object_r:public_content_t:s0
</span></span><span class="line"><span class="cl">Relabeled /tmp/sedir1/sefile1 from staff_u:object_r:etc_t:s0 to staff_u:object_r:public_content_t:s0
</span></span></code></pre></div><p>The output confirms the restoration of the default context on the directory and the file.</p>
<ul>
<li>Restores the type only</li>
</ul>
<p>EXAM TIP: Use the combination of <code>semanage</code> and <code>restorecon</code> commands to add a file context to the SELinux policy and then apply it. This will prevent the context on file to reset to the original value in the event of SELinux relabeling (disabled to enforcing/permissive).</p>
<h3 id="lab-add-and-delete-network-ports">Lab: Add and Delete Network Ports</h3>
<ul>
<li>Add a non-standard network port 8010 to the SELinux policy database for the httpd service.</li>
<li>Confirm the addition.</li>
<li>Remove the port from the policy and verify the deletion.</li>
</ul>
<ol>
<li>List (<code>-l</code>) the ports for the httpd service as defined in the SELinux policy database:</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># semanage port -l | grep ^http_port</span>
</span></span><span class="line"><span class="cl">http_port_t                    tcp      80, 81, 443, 488, 8008, 8009, 8443, <span class="m">9000</span>
</span></span></code></pre></div><p>The output reveals eight network ports the httpd process is currently allowed to listen on.</p>
<ol start="2">
<li>
<p>Add (<code>-a</code>) port 8010 with type (<code>-t</code>) <code>http_port_t</code> and protocol (<code>-p</code>) tcp to the policy:
<code>[root@server10 ~]# semanage port -at http_port_t -p tcp 8010</code></p>
</li>
<li>
<p>Confirm the addition:</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># semanage port -l | grep ^http_port</span>
</span></span><span class="line"><span class="cl">http_port_t                    tcp      8010, 80, 81, 443, 488, 8008, 8009, 8443, <span class="m">9000</span>
</span></span></code></pre></div><ol start="4">
<li>Delete (<code>-d</code>) port <code>8010</code> from the policy and confirm:</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># semanage port -dp tcp 8010</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># semanage port -l | grep ^http_port</span>
</span></span><span class="line"><span class="cl">http_port_t                    tcp      80, 81, 443, 488, 8008, 8009, 8443, <span class="m">9000</span>
</span></span></code></pre></div><p>EXAM TIP: Any non-standard port you want to use for any service, make certain to add it to the SELinux policy database with the correct type.</p>
<h3 id="lab-copy-files-with-and-without-context">Lab: Copy Files with and without Context</h3>
<ul>
<li>Create a file called sefile2 under /tmp and display its context.</li>
<li>Copy this file to the /etc/default directory, and observe the change in the context.</li>
<li>Remove sefile2 from /etc/default, and copy it again to the same destination, ensuring that the target file receives the source file&rsquo;s context.</li>
</ul>
<p>1. Create file sefile2 under /tmp and show context:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># touch /tmp/sefile2</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># ls -lZ /tmp/sefile2</span>
</span></span><span class="line"><span class="cl">-rw-r--r--. <span class="m">1</span> root root unconfined_u:object_r:user_tmp_t:s0 <span class="m">0</span> Jul <span class="m">29</span> 08:44 /tmp/sefile2
</span></span></code></pre></div><p>2. Copy this file to the /etc/default directory, and check the context again:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># cp /tmp/sefile2 /etc/default/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># ls -lZ /etc/default/sefile2</span>
</span></span><span class="line"><span class="cl">-rw-r--r--. <span class="m">1</span> root root unconfined_u:object_r:etc_t:s0 <span class="m">0</span> Jul <span class="m">29</span> 08:45 /etc/default/sefile2
</span></span></code></pre></div><p>3. Erase the <em>/etc/default/sefile2</em> file, and copy it again with the <code>--preserve=context</code> option:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># rm /etc/default/sefile2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># cp --preserve=context /tmp/sefile2 /etc/default</span>
</span></span></code></pre></div><p>4. List the file to view the context:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># ls -lZ /etc/default/sefile2</span>
</span></span><span class="line"><span class="cl">-rw-r--r--. <span class="m">1</span> root root unconfined_u:object_r:user_tmp_t:s0 <span class="m">0</span> Jul <span class="m">29</span> 08:49 /etc/default/sefile2
</span></span></code></pre></div><h3 id="exercise-20-5-view-and-toggle-selinux-boolean-values">Exercise 20-5: View and Toggle SELinux Boolean Values</h3>
<ul>
<li>Display the current state of the Boolean <code>nfs_export_all_rw</code>.</li>
<li>Toggle its value temporarily, and reboot the system.</li>
<li>Flip its value persistently after the system has been back up.</li>
</ul>
<p>1. Display the current setting of the Boolean <code>nfs_export_all_rw</code> using three different commands&mdash;<code>getsebool</code>, <code>sestatus</code>, and <code>semanage</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># getsebool -a | grep nfs_export_all_rw</span>
</span></span><span class="line"><span class="cl">nfs_export_all_rw --&gt; on
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># sestatus -b | grep nfs_export_all_rw</span>
</span></span><span class="line"><span class="cl">nfs_export_all_rw                           on
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># semanage boolean -l | grep nfs_export_all_rw</span>
</span></span><span class="line"><span class="cl">nfs_export_all_rw              <span class="o">(</span>on   ,   on<span class="o">)</span>  Allow nfs to <span class="nb">export</span> all rw
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># </span>
</span></span></code></pre></div><p>2. Turn off the value of <code>nfs_export_all_rw</code> using the setsebool command by simply furnishing &ldquo;<code>off</code>&rdquo; or &ldquo;<code>0</code>&rdquo; with it and confirm:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># setsebool nfs_export_all_rw 0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># getsebool -a | grep nfs_export_all_rw</span>
</span></span><span class="line"><span class="cl">nfs_export_all_rw --&gt; off
</span></span></code></pre></div><p>3. Reboot the system and rerun the <code>getsebool</code> command to check the Boolean state:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># getsebool -a | grep nfs_export_all_rw</span>
</span></span><span class="line"><span class="cl">nfs_export_all_rw --&gt; on
</span></span></code></pre></div><p>4. Set the value of the Boolean persistently (<code>-P</code> or <code>-m</code> as needed) using either of the following:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># setsebool -P nfs_export_all_rw off</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># semanage boolean -m -0 nfs_export_all_rw</span>
</span></span></code></pre></div><p>5. Validate the new value using the getsebool, sestatus, or semanage command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># sestatus -b | grep nfs_export_all_rw</span>
</span></span><span class="line"><span class="cl">nfs_export_all_rw                           off
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># semanage boolean -l | grep nfs_export_all_rw</span>
</span></span><span class="line"><span class="cl">nfs_export_all_rw              <span class="o">(</span>off  ,  off<span class="o">)</span>  Allow nfs to <span class="nb">export</span> all rw
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># semanage boolean -l | grep nfs_export_all_rw </span>
</span></span><span class="line"><span class="cl">nfs_export_all_rw              <span class="o">(</span>off  ,  off<span class="o">)</span>  Allow nfs to <span class="nb">export</span> all rw
</span></span></code></pre></div><h3 id="monitoring-and-analyzing-selinux-violations">Monitoring and Analyzing SELinux Violations</h3>
<ul>
<li>
<p>SELinux generates alerts for system activities when it runs in enforcing or permissive mode.</p>
</li>
<li>
<p>It writes the alerts to <em>/var/log/audit/audit.log</em>if the <strong>auditd</strong> daemon is running, or to <em>/var/log/messages</em> via the <strong>rsyslog</strong> daemon in the absence of <strong>auditd</strong>.</p>
</li>
<li>
<p>SELinux also logs the alerts that are generated due to denial of an action, and identifies them with a type tag <strong>AVC (Access Vector Cache)</strong> in the audit.log file.</p>
</li>
<li>
<p>It also writes the rejection in the messages file with a message ID, and how to view the message details.</p>
</li>
<li>
<p>SELinux denial messages are analyzed, and the audit data is examined to identify the potential cause of the rejection.</p>
</li>
<li>
<p>The results of the analysis are recorded with recommendations on how to fix it.</p>
</li>
<li>
<p>These results can be reviewed to aid in troubleshooting, and recommended actions taken to address the issue.</p>
</li>
<li>
<p>SELinux runs a service daemon called <strong>setroubleshootd</strong> that performs this analysis and examination in the background.</p>
</li>
<li>
<p>This service also has a client interface called <strong>SELinux Troubleshooter</strong> (the <code>sealert</code> command) that reads the data and displays it for assessment.</p>
</li>
<li>
<p>The client tool has both text and graphical interfaces.</p>
</li>
<li>
<p>The server and client components are part of the <code>setroubleshoot-server</code> software package that must be installed on the system prior to using this service.</p>
</li>
</ul>
<p>How SELinux handles an incoming access request (from a subject) to a target object:</p>
<p>Subject (eg: a process) makes an Action request (eg: read) &gt; SELinux Security Server checks the SELinux Policy Database &gt; if permission is not granted the AVC Denied Message is diaplayed. If Permission is granted, then access to object (eg: a file) is granted.</p>
<p>su to root from user1 and view the log:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># cat /var/log/audit/audit.log | tail -10</span>
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl"><span class="nv">type</span><span class="o">=</span>USER_START <span class="nv">msg</span><span class="o">=</span>audit<span class="o">(</span>1722274070.748:90<span class="o">)</span>: <span class="nv">pid</span><span class="o">=</span><span class="m">1394</span> <span class="nv">uid</span><span class="o">=</span><span class="m">1000</span> <span class="nv">auid</span><span class="o">=</span><span class="m">0</span> <span class="nv">ses</span><span class="o">=</span><span class="m">1</span> <span class="nv">subj</span><span class="o">=</span>unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 <span class="nv">msg</span><span class="o">=</span><span class="s1">&#39;op=PAM:session_open grantors=pam_keyinit,pam_limits,pam_systemd,pam_unix,pam_umask,pam_xauth acct=&#34;root&#34; exe=&#34;/usr/bin/su&#34; hostname=? addr=? terminal=/dev/pts/0 res=success&#39;</span><span class="nv">UID</span><span class="o">=</span><span class="s2">&#34;user1&#34;</span> <span class="nv">AUID</span><span class="o">=</span><span class="s2">&#34;root&#34;</span>
</span></span></code></pre></div><p>WIll show avc denied if denied.</p>
<h3 id="lab-get-an-avc-deny-message">Lab Get an AVC deny message</h3>
<ul>
<li>Change the SELinux type on the shadow file to something random (etc_t).</li>
<li>Issue the <code>passwd</code> command as user1 to modify the password.</li>
<li>Restored the type on the shadow file with <code>restorecon /etc/shadow</code>. '</li>
<li>Re-try the password change.</li>
</ul>
<ol>
<li>Change the SELinux type on <em>/etc/shadow</em> to something random (etc_t)</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># chcon -vt etc_t /etc/shadow</span>
</span></span><span class="line"><span class="cl">changing security context of <span class="s1">&#39;/etc/shadow&#39;</span>
</span></span></code></pre></div><ol start="2">
<li>Issue the <code>passwd</code> command as user1 to modify the password:</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server10 ~<span class="o">]</span><span class="c1"># su user1</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>user1@server10 root<span class="o">]</span>$ passwd
</span></span><span class="line"><span class="cl">Changing password <span class="k">for</span> user user1.
</span></span><span class="line"><span class="cl">Current password: 
</span></span><span class="line"><span class="cl">roopasswd: Authentication token manipulation error
</span></span></code></pre></div><p>The following is a sample denial record from the same file in raw format:</p>
<p><img src="davidvargasxyz.github.io/docs/images/image-C7TMRBJO.jpg" alt=""></p>
<p>I got this for some reason:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">type</span><span class="o">=</span>USER_CHAUTHTOK <span class="nv">msg</span><span class="o">=</span>audit<span class="o">(</span>1722275037.346:97<span class="o">)</span>: <span class="nv">pid</span><span class="o">=</span><span class="m">1452</span> <span class="nv">uid</span><span class="o">=</span><span class="m">1000</span> <span class="nv">auid</span><span class="o">=</span><span class="m">0</span> <span class="nv">ses</span><span class="o">=</span><span class="m">1</span> <span class="nv">subj</span><span class="o">=</span>unconfined_u:unconfined_r:passwd_t:s0-s0:c0.c1023 <span class="nv">msg</span><span class="o">=</span><span class="s1">&#39;op=PAM:chauthtok grantors=? acct=&#34;user1&#34; exe=&#34;/usr/bin/passwd&#34; hostname=server10 addr=? terminal=pts/0 res=failed&#39;</span><span class="nv">UID</span><span class="o">=</span><span class="s2">&#34;user1&#34;</span> <span class="nv">AUID</span><span class="o">=</span><span class="s2">&#34;root&#34;</span>
</span></span></code></pre></div><ul>
<li>AVC type</li>
<li>Related to the <code>passwd</code> command (comm)</li>
<li>Source context (<code>scontext</code>) <code>unconfined_u:unconfined_r:passwd_t:s0-s0:c0.c1023</code></li>
<li><em>nshadow</em> file (name) with file type (<em>tclass</em>) &ldquo;file&rdquo;</li>
<li>Target context (tcontext) <code>system_u:object_r:etc_t:s0</code></li>
<li>Indicates the SELinux operating mode, which is enforcing <code>permissive=0</code>.</li>
<li>This message indicates that the <em>/etc/shadow</em> file does not have the correct context set on it, and that&rsquo;s why SELinux prevented the <code>passwd</code> command from updating the user&rsquo;s password.</li>
</ul>
<p>Use <code>sealert</code> to analyze (<code>-a</code>) all <strong>AVC</strong> records in the <em>audit.log</em> file. This command produces a formatted report with all relevant details:</p>
<p><img src="davidvargasxyz.github.io/docs/images/image-WYWDQX1V.jpg" alt=""></p>
<ul>
<li>Will try this again, I think a previous labbing is messing me up</li>
</ul>
<h2 id="selinux-review-questions">SELinux Review Questions</h2>
<p>Q. What would the command <code>semanage login -a -s user_u user10</code> do?
A. This command provided will map Linux user user10 with SELinux user user_u.</p>
<hr>
<p>Q. Name the two commands that can be used to modify a Boolean value.
A. The <code>semanage</code> and <code>setsebool</code> commands.</p>
<hr>
<p>Q. Which option is used with the <code>ps</code> command to view the security contexts for processes?
A. The <code>-Z</code> option.</p>
<hr>
<p>Q. What would the command <code>restorecon -F /etc/sysconfig</code> do?
A. The command provided will restore the default SELinux contexts on the specified directory.</p>
<hr>
<p>Q. What is the name of the default SELinux policy used in RHEL 9?
A. The default SELinux policy used in RHEL 9 is targeted.</p>
<hr>
<p>Q. SELinux is an implementation of discretionary access control. True or False?
A. False. SELinux is an implementation of mandatory access control.</p>
<hr>
<p>Q. Where are SELinux denial messages logged in the absence of the
auditd daemon?
A. The SELinux denial messages are logged to the <em>/var/log/messages</em> file.</p>
<hr>
<p>Q. Name the four parts of a process context.
A. The four parts of a process context are user, role, type/domain, and sensitivity level.</p>
<hr>
<p>Q. What would the command <code>sestatus -b | grep nfs_export_all_rw</code> do?
A. The command provided will display the current value of the specified Boolean.</p>
<hr>
<p>Q. Name the directory that stores SELinux Boolean files.
A. The <code>/sys/fs/selinux/booleans</code> directory.</p>
<hr>
<p>Q. What are the two commands to display and modify the SELinux mode?
A. The <code>getenforce</code> and <code>setenforce</code> commands.</p>
<hr>
<p>Q. Name the two SELinux subjects.
A. <strong>User</strong> and <strong>process</strong> are two SELinux subjects.</p>
<hr>
<p>Q. What one task must be done to change the SELinux mode from enforcing to disabled?
A. The system must be rebooted.</p>
<hr>
<p>Q. Which option with the <code>cp</code> command must be specified to preserve SELinux contexts?
A. The <code>--preserve=context</code> option.</p>
<hr>
<p>Q. What is the purpose of the command <code>sestatus</code>?
A. The <code>sestatus</code> command displays SELinux status information.</p>
<hr>
<p>Q. What is the name and location of the SELinux configuration file?
A. The SELinux configuration filename is config and it is located in the <em>/etc/selinux</em> directory.</p>
<hr>
<p>Q. What would the command <code>semanage fcontext -Cl</code> do?
A. The command provided will show recent changes made to the SELinux policy database.</p>
<hr>
<p>Q. Which command can be used to ensure modified contexts will survive file system relabeling?
A. The <code>semanage</code> command.</p>
<hr>
<p>Q. With SELinux running in enforcing mode and one of the services on the system is compromised, all other services will be affected. True or False?
A. False.</p>
<hr>
<p>Q. Name the command that starts the SELinux Troubleshooter program.
A. The command name is <code>sealert</code>.</p>
<h2 id="selinux-diy-labs">SELinux DIY Labs</h2>
<h3 id="lab-disable-and-enable-the-selinux-operating-mode">Lab: Disable and Enable the SELinux Operating Mode</h3>
<ul>
<li>Check and make a note of the current SELinux operating mode.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># getenforce</span>
</span></span><span class="line"><span class="cl">Enforcing
</span></span></code></pre></div><ul>
<li>Modify the configuration file and set the mode to disabled.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># vim /etc/selinux/config </span>
</span></span><span class="line"><span class="cl"><span class="nv">SELINUX</span><span class="o">=</span>permissive
</span></span></code></pre></div><ul>
<li>Reboot the system to apply the change.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># reboot</span>
</span></span></code></pre></div><ul>
<li>Run <code>sudo getenforce</code> to confirm the change when the system is up.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># getenforce</span>
</span></span><span class="line"><span class="cl">Permissive
</span></span></code></pre></div><ul>
<li>Restore the directive&rsquo;s value to enforcing in the configuration file, and reboot to apply the new mode.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># vim /etc/selinux/config</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">SELINUX</span><span class="o">=</span>enforcing
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># reboot</span>
</span></span></code></pre></div><ul>
<li>Run <code>sudo getenforce</code> to confirm the mode when the system is up.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># getenforce</span>
</span></span><span class="line"><span class="cl">Enforcing
</span></span></code></pre></div><h3 id="lab-modify-context-on-files">Lab: Modify Context on Files</h3>
<ul>
<li>Create directory hierarchy <em>/tmp/d1/d2</em>.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># mkdir /tmp/d1</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># mkdir /tmp/d1/d2</span>
</span></span></code></pre></div><ul>
<li>Check the contexts on <em>/tmp/d1</em> and <em>/tmp/d1/d2</em>.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 d1<span class="o">]</span><span class="c1"># ls -ldZ /tmp/d1</span>
</span></span><span class="line"><span class="cl">drwxr-xr-x. <span class="m">3</span> root root unconfined_u:object_r:user_tmp_t:s0 <span class="m">16</span> Jul <span class="m">29</span> 13:17 /tmp/d1
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server30 d1<span class="o">]</span><span class="c1"># ls -ldZ /tmp/d1/d2</span>
</span></span><span class="line"><span class="cl">drwxr-xr-x. <span class="m">2</span> root root unconfined_u:object_r:user_tmp_t:s0 <span class="m">6</span> Jul <span class="m">29</span> 13:17 /tmp/d1/d2
</span></span></code></pre></div><ul>
<li>Change the SELinux type on <em>/tmp/d1</em> to <code>etc_t</code> recursively with the <code>chcon</code> command and confirm.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># chcon -Rv -t etc_t /tmp/d1</span>
</span></span><span class="line"><span class="cl">changing security context of <span class="s1">&#39;/tmp/d1/d2&#39;</span>
</span></span><span class="line"><span class="cl">changing security context of <span class="s1">&#39;/tmp/d1&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># ls -ldZ /tmp/d1</span>
</span></span><span class="line"><span class="cl">drwxr-xr-x. <span class="m">3</span> root root unconfined_u:object_r:etc_t:s0 <span class="m">16</span> Jul <span class="m">29</span> 13:17 /tmp/d1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># ls -ldZ /tmp/d1/d2</span>
</span></span><span class="line"><span class="cl">drwxr-xr-x. <span class="m">2</span> root root unconfined_u:object_r:etc_t:s0 <span class="m">6</span> Jul <span class="m">29</span> 13:17 /tmp/d1/d2
</span></span></code></pre></div><ul>
<li>Add <em>/tmp/d1</em> to the policy database with the <code>semanage</code> command to ensure the new context is persistent on the directory hierarchy.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># semanage fcontext -a -t etc_t /tmp/d1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server30 tmp<span class="o">]</span><span class="c1"># reboot</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># ls -ldZ /tmp/d1</span>
</span></span><span class="line"><span class="cl">drwxr-xr-x. <span class="m">3</span> root root unconfined_u:object_r:etc_t:s0 <span class="m">16</span> Jul <span class="m">29</span> 13:17 /tmp/d1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># ls -ldZ /tmp/d1/d2</span>
</span></span><span class="line"><span class="cl">drwxr-xr-x. <span class="m">2</span> root root unconfined_u:object_r:etc_t:s0 <span class="m">6</span> Jul <span class="m">29</span> 13:17 /tmp/d1/d2
</span></span></code></pre></div><h3 id="lab-add-network-port-to-policy-database">Lab: Add Network Port to Policy Database</h3>
<ul>
<li>Add network port 9005 to the SELinux policy database for the secure HTTP service using the semanage command.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># semanage port -l | grep ^http_port</span>
</span></span><span class="line"><span class="cl">http_port_t                    tcp      80, 81, 443, 488, 8008, 8009, 8443, <span class="m">9000</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># semanage port -at http_port_t -p tcp 9005</span>
</span></span></code></pre></div><ul>
<li>Verify the addition.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># semanage port -l | grep ^http_port</span>
</span></span><span class="line"><span class="cl">http_port_t                    tcp      9005, 80, 81, 443, 488, 8008, 8009, 8443, <span class="m">9000</span>
</span></span></code></pre></div><h3 id="lab-copy-files-with-and-without-context-1">Lab: Copy Files with and without Context</h3>
<ul>
<li>Create file <em>sef1</em> under <em>/tmp</em>.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># touch /tmp/sef1</span>
</span></span></code></pre></div><ul>
<li>Copy the file to the <em>/usr/local</em> directory.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># cp /tmp/sef1 /usr/local</span>
</span></span></code></pre></div><ul>
<li>Check and compare the contexts on both source and destination files.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># ls -lZ /tmp/sef1</span>
</span></span><span class="line"><span class="cl">-rw-r--r--. <span class="m">1</span> root root unconfined_u:object_r:user_tmp_t:s0 <span class="m">0</span> Jul <span class="m">29</span> 13:33 /tmp/sef1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># ls -lZ /usr/local/sef1</span>
</span></span><span class="line"><span class="cl">-rw-r--r--. <span class="m">1</span> root root unconfined_u:object_r:usr_t:s0 <span class="m">0</span> Jul <span class="m">29</span> 13:33 /usr/local/sef1
</span></span></code></pre></div><ul>
<li>Create another file <em>sef2</em> under <em>/tmp</em> and copy it to the <em>/var/local</em> directory using the <code>--preserve=context</code> option with the <code>cp</code> command.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># touch /tmp/sef2</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># cp --preserve=context /tmp/sef2 /var/local/</span>
</span></span></code></pre></div><ul>
<li>Check and compare the contexts on both source and destination files.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># ls -lZ /tmp/sef2 /var/local/sef2</span>
</span></span><span class="line"><span class="cl">-rw-r--r--. <span class="m">1</span> root root unconfined_u:object_r:user_tmp_t:s0 <span class="m">0</span> Jul <span class="m">29</span> 13:35 /tmp/sef2
</span></span><span class="line"><span class="cl">-rw-r--r--. <span class="m">1</span> root root unconfined_u:object_r:user_tmp_t:s0 <span class="m">0</span> Jul <span class="m">29</span> 13:36 /var/local/sef2
</span></span></code></pre></div><h3 id="lab-flip-selinux-booleans">Lab: Flip SELinux Booleans</h3>
<ul>
<li>Check the current value of Boolean <code>ssh_use_tcpd</code> using the <code>getsebool</code> and <code>sestatus</code> commands.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># getsebool -a | grep ssh_use_tcpd</span>
</span></span><span class="line"><span class="cl">ssh_use_tcpd --&gt; off
</span></span></code></pre></div><ul>
<li>Use the <code>setsebool</code> command and toggle the value of the directive.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># setsebool ssh_use_tcpd 1</span>
</span></span></code></pre></div><ul>
<li>Confirm the new value with the <code>getsebool</code>, <code>semanage</code>, or <code>sestatus</code> command.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># getsebool -a | grep ssh_use_tcpd</span>
</span></span><span class="line"><span class="cl">ssh_use_tcpd --&gt; on
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># sestatus -b | grep ssh_use_tcpd</span>
</span></span><span class="line"><span class="cl">ssh_use_tcpd                                on
</span></span><span class="line"><span class="cl"><span class="o">[</span>root@server30 ~<span class="o">]</span><span class="c1"># semanage boolean -l | grep ssh_use_tcpd </span>
</span></span><span class="line"><span class="cl">ssh_use_tcpd                   <span class="o">(</span>on   ,  off<span class="o">)</span>  Allow ssh to use tcpd
</span></span></code></pre></div>
            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
<a href="https://github.com/davidvargasxyz" target="_blank" rel="noopener noreferrer me"
    title="Github">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
</a>
<a href="https://keybase.io/" target="_blank" rel="noopener noreferrer me"
    title="Keybase">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 71 76.3" version="1.1" fill="currentColor" stroke="none">
    <path
        d="M6.68 73.99c-.6-1.3-1.4-3.1-1.8-4l-.6-1.7-2 2.2-2 2.2-.2-4.2c-.3-6 .2-12.2 1.2-16.6 2.3-9.8 9.5-18.7 18.8-23.4l2.1-1-.5-1.5c-.3-.8-.6-2.5-.7-3.6l-.2-2.1-2.1-.2c-3.2-.3-4.9-1.2-6-3.5-.6-1.2-.6-1.4-.4-4.6.2-4.2.5-5.1 1.8-6.5 1.6-1.8 2.7-2.1 6.7-1.9 2.9.2 3.5.3 4.8.9.8.4 1.5.8 1.6.8.1 0 1-1.1 2.1-2.6l1.9-2.7 1.2.7c.7.4 1.5.9 1.9 1.1l.7.4-.6 1.5c-.3.8-.7 2.2-.8 2.9l-.2 1.4 1.7.2c6.1.6 10.7 4.3 12.4 9.9.5 1.8.5 5.3 0 7-.5 1.6-.5 1.7-.1 1.7.7 0 5.4 2.3 7.3 3.5 3.7 2.4 8 6.6 10.4 10.2 4.5 6.7 6.4 14 5.6 22-.4 4.8-1.3 8.6-2.9 12.3l-.6 1.4h-5l1.2-2.4c1.3-2.6 2.3-6.2 2.8-9.4.3-2.2.4-8.2.1-9.3l-.2-.7-1.3 1.4c-3.2 3.5-7.9 4.5-14.2 2.8-5.4-1.4-7.6-1.7-12.7-1.7-3.9 0-5.2.1-7.3.6-5.8 1.3-9.9 3.2-15.6 7.3-2.1 1.5-3.8 2.7-3.9 2.7-.1 0 .2-1 .6-2.3.4-1.3 1.1-3.4 1.5-4.8l.8-2.5-.9.9c-.5.5-1.9 1.9-3.1 3.2l-2.1 2.3.5 1.9c.6 2.5 2 5.6 3.5 7.9.6 1 1.1 1.8 1.1 1.9s-1.2.1-2.6.1h-2.6l-1.1-2.1zm8.8-24.2c4.8-5.1 8.7-9.2 8.8-9.2.1.1-.4 1.6-.9 3.3-3.3 10.4-4 12.4-3.9 12.5 0 0 1.2-.4 2.5-.9 8.5-3.7 18.4-4.2 28.9-1.4 4.7 1.2 6.5 1.2 8.8 0 1.3-.7 1.8-1.1 2.4-2.1 1.1-1.7 1.2-4.1.5-6.3-1.7-4.8-8.3-11-14.5-13.7-3.2-1.4-3.4-1.4-4.1-.7l-.6.6 2.6 3.2c1.4 1.7 2.9 3.6 3.1 4.1.6 1.2.7 3.1.1 4.3-.8 1.7-3.2 2.9-5.1 2.5-.8-.2-1.1-.1-1.9.5-2.2 1.6-4.6 1.2-6.6-1.2-1.6-1.8-2-2.7-2.1-4.5 0-.9-.3-2-.5-2.4-.3-.6-.4-1.3-.4-2.2l.1-1.4-1.3-.3c-1.8-.5-3.9-1.5-5.1-2.4-.6-.4-1.1-.8-1.3-.8s-1.5.6-2.9 1.3c-9.7 5-16 14.3-17 24.8-.1 1-.2 2.3-.3 2.8l-.1.9 1.1-1.1c.5-.5 4.9-5.1 9.7-10.2zm25.9-7.4c.9-.7 1.7-1.3 1.9-1.3.1 0 .4.3.7.7.5.8 1.4.8 1.8.1.3-.5.3-.6-5.6-7.8-3.5-4.3-4.2-5-4.7-5-1.2.1-.9 1 1 3.3l1.8 2.2-1 .8c-1.1 1-1.2 1.2-.5 1.8.5.5.6.4 1.6-.3l1.1-.7.7.6c.4.3.6.8.6.9 0 .2-.8.9-1.7 1.7-.9.7-1.6 1.5-1.6 1.7 0 .3.5 1.1 1.4 2.2.3.6.8.4 2.5-.9zm-10.3-14.2c.6-1.8 2.6-3.2 4.6-3.2 1.1 0 2.7.9 3.8 2.1l1 1.2.9-1.1c2.5-2.8 2.8-6.7.8-10.1-1.5-2.5-4.3-4-8.2-4.4-2.1-.2-2.6-.4-3.7-1.5l-.8-.8-.4.6c-.8 1.2-2.5 5.1-3 6.6-.7 2.3-.4 5.9.5 7.7.9 1.7 3.3 4 4 3.7.1.1.3-.3.5-.8zm-8.9-13.6c.2-.5.7-1.8 1.2-2.8.5-1 .9-2 .9-2.3 0-.9-1-1.3-3.7-1.5-2.4-.2-2.6-.1-3.1.4-.4.4-.6.9-.6 1.6 0 .6-.1 1.7-.2 2.6-.2 2.1.1 2.5 2.2 2.8 3.1.2 3 .2 3.3-.8zm-3.1-2.4c0-1.7.2-1.9 1.6-1.9h1.3v2.8h-2.8v-.9zm6.3 58.3c-.6-.6-.8-1-.8-2 0-1.9 1.1-3 2.9-3 1.7 0 2.9 1.2 2.9 2.9 0 1.8-1.1 2.8-3 2.9-1 0-1.4-.2-2-.8zm19.3.3a2.93 2.93 0 011.8-5.3c1.8 0 2.8 1.1 2.9 3 0 1.1-.1 1.4-.8 2s-1 .8-2 .8c-.9 0-1.5-.2-1.9-.5z" />
</svg>
</a>
<a href="index.xml" target="_blank" rel="noopener noreferrer me"
    title="Rss">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 11a9 9 0 0 1 9 9" />
    <path d="M4 4a16 16 0 0 1 16 16" />
    <circle cx="5" cy="19" r="1" />
</svg>
</a>
</div>
    <small class="footer_copyright">
        © 2024 David Vargas.
        Powered by <a href="https://github.com/hugo-sid/hugo-blog-awesome" target="_blank" rel="noopener">Hugo blog awesome</a>.
    </small>
</footer><a href="#" title="Go to top" id="totop">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    






    
    <script async src="http://localhost:1313/js/main.js" ></script>

    

</body>
</html>
